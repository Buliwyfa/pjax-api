/*
 * 
 * pjax
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT http://opensource.org/licenses/mit-license.php
 * @version 1.30.2
 * @updated 2014/01/16
 * @author falsandtru https://github.com/falsandtru/
 * @Compressor Closure Compiler
 */
(function(m,h,z,v){function C(a,f,k,n,d,b){var l=this;switch(!0){case "object"===typeof b:l=l instanceof a?l:a(k);l=d.setProperties.call(l,b.ns||"",null);if(!b.area)return l;break;default:return l=l instanceof a?l:a[d.name],d.setProperties.call(l,null,null)}var e;e=a.extend(!0,{id:0,gns:d.name,ns:null,area:null,link:"a:not([target])",form:null,scope:null,state:null,scrollTop:0,scrollLeft:0,ajax:{},contentType:"text/html",cache:{click:!1,submit:!1,popstate:!1,get:!0,post:!0,length:9,size:1048576,expire:18E5},
callback:function(){},callbacks:{ajax:{},update:{url:{},title:{},content:{},css:{},script:{},cache:{load:{},save:{}},rendering:{},verify:{}},async:!1},parameter:null,load:{css:!1,script:!1,execute:!0,reload:null,reject:null,sync:!0,ajax:{dataType:"script"},rewrite:null},interval:300,wait:0,scroll:{delay:500},fix:{location:!0,history:!0,scroll:!0,reset:!1},hashquery:!1,fallback:!0,database:!0,server:{},location:a("<a/>",{href:d.canonicalizeURL(f.location.href)})[0],destination:a("<a/>",{href:d.canonicalizeURL(f.location.href)})[0],
speedcheck:!1},b);e.nss={array:[d.name].concat(e.ns&&String(e.ns).split(".")||[])};a.extend(!0,e=e.scope&&d.scope(e)||e,{nss:{name:e.ns||"",event:e.nss.array.join("."),alias:d.alias?[d.alias].concat(e.nss.array.slice(1)).join("."):!1,click:["click"].concat(e.nss.array.join(":")).join("."),submit:["submit"].concat(e.nss.array.join(":")).join("."),popstate:["popstate"].concat(e.nss.array.join(":")).join("."),scroll:["scroll"].concat(e.nss.array.join(":")).join("."),data:e.nss.array.join("-"),class4html:e.nss.array.join("-"),
requestHeader:["X",e.nss.array[0].replace(/^\w/,function(d){return d.toUpperCase()})].join("-")},areaback:e.area,fix:/Mobile(\/\w+)? Safari/i.test(f.navigator.userAgent)?{}:{location:!1,reset:!1},contentType:e.contentType.replace(/\s*[,;]\s*/g,"|").toLowerCase(),scroll:{record:!0,queue:[]},database:e.database?f.indexedDB||f.webkitIndexedDB||f.mozIndexedDB||f.msIndexedDB||null:!1,server:{query:e.server.query?e.server.query:e.gns},log:{script:{},speed:{}},history:{config:e.cache,order:[],data:{},size:0},
timestamp:(new Date).getTime(),disable:!1,landing:d.canonicalizeURL(f.location.href),retry:!0,xhr:null,speed:{now:function(){return(new Date).getTime()}},option:b,validator:validator});d.check()&&d.registrate.call(l,a,f,k,n,d,e);return l}var c;c={name:"pjax",alias:"",ids:[0],settings:[0],count:0,parseHTML:null,setAlias:function(a){c.alias="string"===typeof a?a:c.alias;c.name===c.alias||m[c.alias]||(m[c.name][c.alias]=m.fn[c.name],m.fn[c.alias]=m[c.alias]=m.fn[c.name])},setProperties:function(a,f){var k=
this;if(k instanceof m||k===m[c.name])k=k instanceof m&&f!==v?k.add(f):k,k[c.name]=m[c.name],k.on=function(){c.settings[1].disable=!1},k.off=function(){c.settings[1].disable=!0},k.click=function(a,d){d=d||{};return(d.href=a)?m("<a/>",d).one("click",1,c.click).click():!1},k.submit=function(a,d,b){var l=z.createDocumentFragment(),e;switch(!0){case "object"===typeof a:d=m(a);break;case !!b:d=d||{};d.action=a;a=b instanceof Array&&Array||b instanceof Object&&Object||v;for(var f in b){e=b[f];switch(a){case Object:e=
m("<textarea/>",{name:f}).val(e);break;case Array:e.attr=e.attr||{};e.attr.name=e.name;e=m(e.tag.indexOf("<")?"<"+e.tag+"/>":e.tag,e.attr||{}).val(e.value);break;default:continue}l.appendChild(e[0])}d=m("<form/>",d).append(l);break;default:return!1}d.one("submit",1,c.submit).submit();return!0},k.setCache=function(a,d,b,l){var e=c.settings[1];if(!e||!e.history)return!1;var f,k,u;f=e.history;a=a||c.canonicalizeURL(h.location.href);e.hashquery||(a=a.replace(/#.*/,""));switch(arguments.length){case 0:case 1:return arguments.callee.call(this,
a,c.trim(z.documentElement.outerHTML));default:f.order.unshift(a);for(k=1;u=f.order[k];k++)a===u&&f.order.splice(k,1);f.size>f.config.size&&m[c.name].cleanCache();m[c.name].getCache(a);k=m("<span/>").html(c.find((d||"")+((l||{}).responseText||"")+"<title></title>",/<title[^>]*?>([^<]*?)<\/title>/i).shift()).text();u=parseInt(1.8*((d||"").length+((l||{}).responseText||"").length)||1048576,10);f.size=f.size||0;f.size+=u;f.data[a]=m.extend(!0,f.data[a]||{},{XMLHttpRequest:l,textStatus:b,data:d,size:u,
timestamp:(new Date).getTime()});e.database&&e.fix.history&&c.dbTitle(a,k)}return f.data[a]},k.getCache=function(a){var d=c.settings[1];if(!d||!d.history)return!1;var b;b=d.history;a=a||c.canonicalizeURL(h.location.href);d.hashquery||(a=a.replace(/#.*/,""));b.data[a]&&d.timestamp>b.data[a].timestamp+b.config.expire&&m[c.name].removeCache(a);return b.data[a]},k.removeCache=function(a){var d=c.settings[1];if(!d||!d.history)return!1;var b;b=d.history;a=a||c.canonicalizeURL(h.location.href);d.hashquery||
(a=a.replace(/#.*/,""));for(var d=0,l;l=b.order[d];d++)a===l&&(b.order.splice(d,1),b.size-=b.data[l].size,b.data[l]=null,delete b.data[l]);return!0},k.clearCache=function(){var a=c.settings[1];if(!a||!a.history)return!1;for(var a=a.history,d=a.order.length,b;b=a.order[--d];)a.order.splice(d,1),a.size-=a.data[b].size,delete a.data[b];return!0},k.cleanCache=function(){var a=c.settings[1];if(!a||!a.history)return!1;for(var d=a.history,b=d.order.length,l;l=d.order[--b];)if(b>=d.config.length||l in d.data&&
a.timestamp>d.data[l].timestamp+d.config.expire)d.order.splice(b,1),d.size-=d.data[l].size,delete d.data[l];return!0};return k},check:function(){return c.supportPushState()},supportPushState:function(){return"pushState"in h.history&&h.history.pushState},registrate:function(a,f,k,n,d,b){b.id=1;d.ids.push(b.id);d.settings[b.id]=b;d.share();d.database();b.load.script&&a("script").each(function(){var l=this,e,l="function"===typeof b.load.rewrite?d.fire(b.load.rewrite,null,[l.cloneNode()])||l:l;(e=l.src)&&
e in b.log.script||!e||b.load.reload&&a(l).is(b.load.reload)||(b.log.script[e]=!0)});a(this).undelegate(b.link,b.nss.click).delegate(b.link,b.nss.click,b.id,d.click=function(b){b.timeStamp=(new Date).getTime();var e=d.settings[1];if(e.disable||b.isDefaultPrevented())return b.preventDefault();e.location.href=d.canonicalizeURL(f.location.href);e.destination.href=d.canonicalizeURL(this.href);if(e.location.protocol===e.destination.protocol&&e.location.host===e.destination.host&&!(1<b.which||b.metaKey||
b.ctrlKey||b.shiftKey||b.altKey)){if(!d.fire(e.hashquery,null,[b,this.href])&&e.location.pathname+e.location.search===e.destination.pathname+e.destination.search)return e.destination.hash&&d.hashscroll(),b.preventDefault();var c,m;c=e.destination.href;e.area=d.fire(e.areaback,null,[b,c]);e.timestamp=b.timeStamp;e.landing&&(e.landing=!1);if(a(e.area).length&&(!e.scope||d.scope(e)))return e.cache[b.type.toLowerCase()]&&(m=a[d.name].getCache(c)),d.drive(a,f,k,n,d,e,b,c,!0,m),b.preventDefault()}});a(this).undelegate(b.form,
b.nss.submit).delegate(b.form,b.nss.submit,b.id,d.submit=function(b){b.timeStamp=(new Date).getTime();var e=d.settings[1];if(e.disable||b.isDefaultPrevented())return b.preventDefault();e.location.href=d.canonicalizeURL(f.location.href);e.destination.href=d.canonicalizeURL(this.action);if(!(1<b.which||b.metaKey||b.ctrlKey||b.shiftKey||b.altKey)){var c,m;c=e.destination.href=d.canonicalizeURL(e.destination.href.replace(/[?#].*/,"")+("GET"===b.target.method.toUpperCase()?"?"+a(b.target).serialize():
""));e.area=d.fire(e.areaback,null,[b,c]);e.timestamp=b.timeStamp;e.landing&&(e.landing=!1);if(a(e.area).length&&(!e.scope||d.scope(e)))return e.cache[b.type.toLowerCase()]&&e.cache[b.target.method.toLowerCase()]&&(m=a[d.name].getCache(c)),d.drive(a,f,k,n,d,e,b,c,!0,m),b.preventDefault()}});a(f).unbind(b.nss.popstate).bind(b.nss.popstate,b.id,d.popstate=function(b){b.timeStamp=(new Date).getTime();var e=d.settings[1];if(e.disable||b.isDefaultPrevented())return b.preventDefault();e.destination.href=
d.canonicalizeURL(f.location.href);if(e.location.href===e.destination.href)return b.preventDefault();var c,m;if(!d.fire(e.hashquery,null,[b,c])&&e.location.pathname+e.location.search===e.destination.pathname+e.destination.search)return b.preventDefault();c=e.destination.href;e.area=d.fire(e.areaback,null,[b,c]);e.timestamp=b.timeStamp;if(e.landing){if(e.landing.href===c){e.landing=!1;return}e.landing=!1}if(a(e.area).length)return e.database&&e.fix.history&&d.dbTitle(c),e.cache[b.type.toLowerCase()]&&
(m=a[d.name].getCache(c)),d.drive(a,f,k,n,d,e,b,c,!1,m),b.preventDefault()});b.database&&b.fix.scroll&&a(f).unbind(b.nss.scroll).bind(b.nss.scroll,b.id,function(b,e){var k=d.settings[1],c;if(k.scroll.delay){for(;c=k.scroll.queue.shift();)clearTimeout(c);c=setTimeout(function(){for(;c=k.scroll.queue.shift();)clearTimeout(c);d.dbScroll(a(f).scrollLeft(),a(f).scrollTop())},k.scroll.delay);k.scroll.queue.push(c)}else d.dbScroll(a(f).scrollLeft(),a(f).scrollTop())});(function(){function b(d){try{var e=
d&&d("<body><noscript>DOMParser</noscript></body>");return"DOMParser"===a(e).find("noscript").text()}catch(f){}}var e=f.DOMParser;d.parseHTML=function(a){return e&&e.prototype&&(new e).parseFromString(a,"text/html")};b(d.parseHTML)||(d.parseHTML=function(a){var b;k.implementation&&k.implementation.createHTMLDocument&&(b=k.implementation.createHTMLDocument(""),"object"===typeof b.activeElement&&(b.open(),b.write(a),b.close()));return b},b(d.parseHTML)||(d.parseHTML=!1))})()},drive:function(a,f,c,n,
d,b,l,e,m,t){function u(a,b,d,f,c,g,k,l){a:{var n=g.callbacks.update;if(!1!==c.fire(n.before,null,[k,g.parameter,r,s,p,l],g.callbacks.async)){var h,t,u;try{if(!l&&-1===(p.getResponseHeader("Content-Type")||"").toLowerCase().search(g.contentType))throw Error("throw: content-type mismatch");l&&!1!==c.fire(n.cache.load.before,null,[k,g.parameter,l],g.callbacks.async)&&(p=l.XMLHttpRequest||p,r=p.responseText,s=l.textStatus||s,t=l.css,u=l.script,c.fire(n.cache.load.after,null,[k,g.parameter,l],g.callbacks.async));
var w,q,x,v,y,z,B;z=g.area.split(/\s*,\s*/);q=(p.responseText||"").replace(/<noscript[^>]*>(?:.|[\n\r])*?<\/noscript>/gim,function(a){return a.replace(/<script(?:.|[\n\r])*?<\/script>/gim,"")});if(l&&l.data){v=l.data;x=a(c.parseHTML&&v&&c.parseHTML(v)||v);q=q.replace(/<title[^>]*?>([^<]*?)<\/title>/i,function(a){return c.find(v,/(<title[^>]*?>[^<]*?<\/title>)/i).shift()||a});w=a(c.parseHTML&&q&&c.parseHTML(q)||q);for(var G=0,A,H;A=z[G++];)w.find(A).add(y?"":w.filter(A)).html(x.find(A).add(y?"":x.filter(A)).contents())}else w=
a(c.parseHTML&&q&&c.parseHTML(q)||q);switch(!0){case !!w.find("html")[0]:y=1;w.find("noscript").each(function(){this.children.length&&a(this).text(this.innerHTML)});break;case !!w.filter("title")[0]:y=0;break;default:y=!1}switch(y){case 1:h=w.find("title").text();break;case 0:h=w.filter("title").text();break;case !1:h=a("<span/>").html(c.find(q,/<title[^>]*?>([^<]*?)<\/title>/i).shift()).text()}if(!a(g.area).length||!w.find(g.area).add(y?"":w.filter(g.area)).length)throw Error("throw: area length mismatch");
a(b).trigger(g.gns+".unload");!1!==c.fire(n.url.before,null,[k,g.parameter,r,s,p],g.callbacks.async)&&(m&&e!==g.location.href&&b.history.pushState(c.fire(g.state,null,[k,e]),b.opera||-1!==b.navigator.userAgent.toLowerCase().indexOf("opera")?h:d.title,e),g.location.href=e,m&&g.fix.location&&(a[c.name].off(),b.history.back(),b.history.forward(),a[c.name].on()),c.fire(n.url.after,null,[k,g.parameter,r,s,p],g.callbacks.async));!1!==c.fire(n.title.before,null,[k,g.parameter,r,s,p],g.callbacks.async)&&
(d.title=h,g.database&&g.fix.history&&c.dbTitle(e,h),c.fire(n.title.after,null,[k,g.parameter,r,s,p],g.callbacks.async));g.database&&c.dbCurrent();var I=function(d){var e,f;switch(k.type.toLowerCase()){case "click":case "submit":e=d&&"function"===typeof g.scrollLeft?c.fire(g.scrollLeft,null,[k]):g.scrollLeft;e=0<=e?e:0;e=null===e?a(b).scrollLeft():parseInt(Number(e),10);f=d&&"function"===typeof g.scrollTop?c.fire(g.scrollTop,null,[k]):g.scrollTop;f=0<=f?f:0;f=null===f?a(b).scrollTop():parseInt(Number(f),
10);a(b).scrollTop()===f&&a(b).scrollLeft()===e||b.scrollTo(e,f);d&&g.database&&g.fix.scroll&&c.dbScroll(e,f);break;case "popstate":d&&g.database&&g.fix.scroll&&c.dbScroll()}};I(!1);if(!1!==c.fire(n.content.before,null,[k,g.parameter,r,s,p],g.callbacks.async)){a(g.area).children("."+g.nss.class4html+"-check").remove();B=a("<div/>",{"class":g.nss.class4html+"-check",style:"background: none !important; display: block !important; visibility: hidden !important; position: absolute !important; top: 0 !important; left: 0 !important; z-index: -9999 !important; width: auto !important; height: 0 !important; margin: 0 !important; padding: 0 !important; border: none !important; font-size: 12px !important; text-indent: 0 !important;"}).text(g.gns);
for(G=0;A=z[G++];)H=w.find(A).add(y?"":w.filter(A)).clone().find("script").remove().end().contents(),a(A).html(H).append(B.clone());B=a(g.area).children("."+g.nss.class4html+"-check");a(d).trigger(g.gns+".DOMContentLoaded");c.fire(n.content.after,null,[k,g.parameter,r,s,p],g.callbacks.async)}l&&l.XMLHttpRequest||!g.cache.click&&!g.cache.submit&&!g.cache.popstate||"submit"===k.type.toLowerCase()&&!g.cache[k.target.method.toLowerCase()]||!1===c.fire(n.cache.save.before,null,[k,g.parameter,l],g.callbacks.async)||
(a[c.name].setCache(e,v||null,s,p),l=a[c.name].getCache(e),c.fire(n.cache.save.after,null,[k,g.parameter,l],g.callbacks.async));var J=function(b){if(!1!==c.fire(n.rendering.before,null,[k,g.parameter],g.callbacks.async)){var d=0;(function(){B.filter(function(){return this.clientWidth||this.clientHeight||a(this).is(":hidden")}).length===B.length||100<=d?C(b):B.length&&(d++,setTimeout(arguments.callee,g.interval))})()}},C=function(d){B.remove();g.scroll.record=!0;c.hashscroll("popstate"===k.type.toLowerCase())||
I(!0);a(b).trigger(g.gns+".load");c.fire(d);c.fire(n.rendering.after,null,[k,g.parameter],g.callbacks.async)};switch(y){case 1:case 0:w.find("noscript").remove();break;case !1:q=q.replace(/^(?:.|[\n\r])*<body[^>]*>.*[\n\r]*.*[\n\r]*/im,function(a){return a.replace(/\x3c!--\[(?:.|[\n\r])*?<!\[endif\]--\x3e/gim,"")}),q=q.replace(/<noscript(?:.|[\n\r])*?<\/noscript>/gim,"")}var F=function(d){if(g.load.script&&!1!==c.fire(n.script.before,null,[k,g.parameter,r,s,p],g.callbacks.async)){var f;f=(l=a[c.name].getCache(e))&&
!l.script;switch(u||y){case 1:case 0:u=w.find("script").add(y?"":w.filter("script")).clone().get();break;case !1:u=c.find(q,/(?:[^\'\"]|^\s*?)(<script[^>]*?>(?:.|[\n\r])*?<\/script>)(?:[^\'\"]|\s*?$)/gim)}l&&l.script&&u&&u.length!==l.script.length&&(f=!0);f&&(l.script=[]);for(var m=0,h,t;h=u[m];m++)if(h="object"===typeof h?f?a(h.outerHTML)[0]:h:a(h)[0],h="function"===typeof g.load.rewrite?c.fire(g.load.rewrite,null,[h.cloneNode()])||h:h,f&&(l.script[m]=h),a(h).is(d)&&(t=c.trim(h.src||""),!(t&&t in
g.log.script||g.load.reject&&a(h).is(g.load.reject)))){!t||g.load.reload&&a(h).is(g.load.reload)||(g.log.script[t]=!0);try{t?a.ajax(a.extend(!0,{},g.ajax,g.load.ajax,{url:h.src,async:!!h.async,global:!1})):"object"!==typeof h||h.type&&-1===h.type.toLowerCase().indexOf("text/javascript")||b.eval.call(b,(h.text||h.textContent||h.innerHTML||"").replace(/^\s*<!(?:\[CDATA\[|\-\-)/,"/*$0*/"))}catch(D){break}}c.fire(n.script.after,null,[k,g.parameter,r,s,p],g.callbacks.async)}};if(!1!==c.fire(n.verify.before,
null,[k,g.parameter],g.callbacks.async)){if(e===c.canonicalizeURL(b.location.href))g.retry=!0;else if(g.retry)g.retry=!1,c.drive(a,b,d,f,c,g,k,b.location.href,!1,g.cache[k.type.toLowerCase()]&&a[c.name].getCache(c.canonicalizeURL(b.location.href)));else throw Error("throw: location mismatch");c.fire(n.verify.after,null,[k,g.parameter],g.callbacks.async)}(function(){if(g.load.css&&!1!==c.fire(n.css.before,null,[k,g.parameter,r,s,p],g.callbacks.async)){var b,d=[],f=a('link[rel~="stylesheet"], style');
b=(l=a[c.name].getCache(e))&&!l.css;switch(t||y){case 1:case 0:t=w.find('link[rel~="stylesheet"], style').add(y?"":w.filter('link[rel~="stylesheet"], style')).clone().get();break;case !1:t=c.find(q,/(<link[^>]*?rel=.[^"\']*?stylesheet[^>]*?>|<style[^>]*?>(?:.|[\n\r])*?<\/style>)/gim)}l&&l.css&&t&&t.length!==l.css.length&&(b=!0);b&&(l.css=[]);for(var m=0,h,u;h=t[m];m++){h="object"===typeof h?b?a(h.outerHTML)[0]:h:a(h)[0];h="function"===typeof g.load.rewrite?c.fire(g.load.rewrite,null,[h.cloneNode()])||
h:h;b&&(l.css[m]=h);u=c.trim(h.href||h.innerHTML||"");for(var D=0,v;v=f[D];D++)if(c.trim(v.href||v.innerHTML||"")===u){f=f.not(v);h=null;break}h&&d.push(h)}f.remove();a("head").append(d);c.fire(n.css.after,null,[k,g.parameter,r,s,p],g.callbacks.async)}})();a(d).trigger(g.gns+".ready");a(b).bind(g.gns+".rendering",function(b){a(b.target).unbind(b.type+".rendering",arguments.callee);F(":not([defer]), :not([src])");g.load.sync?J(function(){F("[src][defer]")}):(J(),F("[src][defer]"))}).trigger(g.gns+
".rendering");if(!1===c.fire(n.success,null,[k,g.parameter,r,s,p],g.callbacks.async))break a;if(!1===c.fire(n.complete,null,[k,g.parameter,r,s,p],g.callbacks.async))break a;if(!1===c.fire(g.callback,null,[k,g.parameter,r,s,p],g.callbacks.async))break a}catch(L){l&&a[c.name].removeCache(e);if(!1===c.fire(n.error,null,[k,g.parameter,r,s,p],g.callbacks.async))break a;if(!1===c.fire(n.complete,null,[k,g.parameter,r,s,p],g.callbacks.async))break a;if(g.fallback)return"function"===typeof g.fallback?c.fire(g.fallback,
null,[k,e]):c.fallback(k)}c.fire(n.after,null,[k,g.parameter,r,s,p],g.callbacks.async)}}}b.scroll.record=!1;b.fix.reset&&/click|submit/.test(l.type.toLowerCase())&&f.scrollTo(a(f).scrollLeft(),0);if(!1!==d.fire(b.callbacks.before,null,[l,b.parameter],b.callbacks.async))if(t&&t.XMLHttpRequest)a.when?a.when(d.wait(b.wait)).done(function(){u(a,f,c,n,d,b,l,t)}):u(a,f,c,n,d,b,l,t);else{var q,h,r,p,s,x;q={};switch(l.type.toLowerCase()){case "click":q.type="GET";break;case "submit":q.type=l.target.method.toUpperCase();
"POST"===q.type&&(q.data=a(l.target).serializeArray());break;case "popstate":q.type="GET"}h=a.when?a.Deferred():null;a.extend(!0,q,b.ajax,{xhr:b.callbacks.ajax.xhr?function(){p=d.fire(b.callbacks.ajax.xhr,null,[l,b.parameter],b.callbacks.async);return p="object"===typeof p&&p||a.ajaxSettings.xhr()}:n,beforeSend:function(a,e){p=a;b.xhr&&4>b.xhr.readyState&&b.xhr.abort();b.xhr=p;p.setRequestHeader(b.nss.requestHeader,"true");p.setRequestHeader(b.nss.requestHeader+"-Area",b.area);p.setRequestHeader(b.nss.requestHeader+
"-CSS",b.load.css);p.setRequestHeader(b.nss.requestHeader+"-Script",b.load.script);d.fire(b.callbacks.ajax.beforeSend,null,[l,b.parameter,p,e],b.callbacks.async)},dataFilter:b.callbacks.ajax.dataFilter?function(a,e){r=a;return d.fire(b.callbacks.ajax.dataFilter,null,[l,b.parameter,r,e],b.callbacks.async)||r}:n,success:function(a,e,c){r=a;s=e;p=c;d.fire(b.callbacks.ajax.success,null,[l,b.parameter,r,s,p],b.callbacks.async)},error:function(a,e,c){p=a;s=e;x=c;d.fire(b.callbacks.ajax.error,null,[l,b.parameter,
p,s,x],b.callbacks.async)},complete:function(m,q){p=m;s=q;d.fire(b.callbacks.ajax.complete,null,[l,b.parameter,p,s],b.callbacks.async);if(x){if(h&&h.reject(),b.fallback&&"abort"!==s)return"function"===typeof b.fallback?d.fire(b.fallback,null,[l,e]):d.fallback(l)}else h&&h.resolve()||u(a,f,c,n,d,b,l,t)}});q.url=e.replace(/([^#]+)(#[^\s]*)?$/,"$1"+(b.server.query?(e.match(/\?/)?"&":"?")+encodeURIComponent(b.server.query)+"=1":"")+"$2");a.when&&a.when(h.promise(),d.wait(b.wait)).done(function(){u(a,
f,c,n,d,b,l,t)});a.ajax(q);d.fire(b.callbacks.after,null,[l,b.parameter],b.callbacks.async)}},canonicalizeURL:function(a){a=c.trim(a);a=/^https?:/i.test(a)?a:"";a=a.replace(/[<>"{}|\\^\[\]`\s].*/,"");return encodeURI(decodeURI(a))},trim:function(a){if(String.prototype.trim)a=String(a).trim();else if(a=String(a).replace(/^\s+/,""))for(var c=a.length;--c;)if(/\S/.test(a.charAt(c))){a=a.substring(0,c+1);break}return a},fire:function(a,c,k,n){return"function"===typeof a?n?setTimeout(function(){a.apply(c,
k)},0):a.apply(c,k):a},hashscroll:function(a){var f=c.settings[1].destination.hash.slice(1);return!(a||!f)&&m("#"+(f?f:", [name~="+f+"]")).first().each(function(){isFinite(m(this).offset().top)&&h.scrollTo(m(h).scrollLeft(),parseInt(Number(m(this).offset().top),10))}).length},wait:function(a){var c=m.Deferred();if(!a)return c.resolve();setTimeout(function(){c.resolve()},a);return c.promise()},fallback:function(a){switch(a.type.toLowerCase()){case "click":h.location.href=a.currentTarget.href;break;
case "submit":a.target.submit();break;case "popstate":h.location.reload()}},find:function(a,c){var k=[];a.replace(c,function(a,d){k.push(d)});return k},scope:function(a,f){var k,n,d,b,l,e,h,t,u,q,z,r,p,s;k=a.scope;d=a.location.pathname+a.location.search+a.location.hash;b=a.destination.pathname+a.destination.search+a.destination.hash;"/"!==a.location.pathname.charAt(0)&&(d="/"+d,b="/"+b);n=d.replace(/^\//,"").replace(/([?#])/g,"/$1").split("/");e=(f||d).replace(/^\//,"").replace(/([?#])/g,"/$1").split("/");
if(f){if(-1===f.indexOf("*"))return v;l=[];for(var x=e.length;x--;)"*"===e[x]&&l.unshift(n[x])}for(x=e.length+1;x--;)if(q=z=r=p=v,n=e.slice(0,x).join("/").replace(/\/([?#])/g,"$1"),(n="/"+n+("/"===(f||d).charAt(n.length+1)?"/":""))&&n in k){if(!k[n]||!k[n].length)return!1;for(var C=0;h=k[n][C];C++)if(!1!==r&&!1!==p)if("rewrite"!==h||"function"!==typeof k.rewrite||f)if("inherit"===h)z=!0;else if("string"===typeof h){h=(t="^"===h.charAt(0))?h.slice(1):h;h=(u="*"===h.charAt(0))?h.slice(1):h;if(f&&-1!==
h.indexOf("/*/"))for(var E=0,K=l.length;E<K;E++)h=h.replace("/*/","/"+l[E]+"/");if(!(!t&&r||(u?d.search(h):d.indexOf(h)))){if(t)return!1;r=!0}if(!(!t&&p||(u?b.search(h):b.indexOf(h)))){if(t)return!1;p=!0}}else"object"===typeof h&&(s=h);else if(q=arguments.callee(a,c.fire(k.rewrite,null,[a.destination.href])))r=p=!0;else if(!1===q)return!1;if(r&&p)return a.option||q?m.extend(!0,{},q||{}):m.extend(!0,{},a,s||{},q||{});if(!z)break}},database:function(a){var f=c.settings[1],k=1,h=f.database,d=f.gns,b,
l,e=Math.floor(f.timestamp/864E5);a=a||0;if(!h||!d||!h.open||3<a)return f.database=!1;try{k=parseInt(e-e%7+k,10),b=h.open(d),b.onblocked=function(){},b.onupgradeneeded=function(){var a=f.database=this.result;try{for(var b=a.objectStoreNames?a.objectStoreNames.length:0;b--;)a.deleteObjectStore(a.objectStoreNames[b]);f.database.createObjectStore(f.gns,{keyPath:"id",autoIncrement:!1}).createIndex("date","date",{unique:!1})}catch(d){}},b.onsuccess=function(){try{f.database=this.result,l=c.dbStore(),l.get("_version").onsuccess=
function(){this.result&&k!==this.result.title?(f.database.close(),h.deleteDatabase(d),f.database=h,c.database()):(c.dbVersion(k),c.dbCurrent(),c.dbTitle(f.location.href,z.title))}}catch(a){f.database.close(),h.deleteDatabase(d),f.database=!1}},b.onerror=function(b){h.deleteDatabase(d);setTimeout(function(){database(++a)},1E3)}}catch(m){f.database=!1}},dbStore:function(){var a=c.settings[1];return"object"===typeof a.database&&"function"===typeof a.database.transaction&&a.database.transaction(a.gns,
"readwrite").objectStore(a.gns)},dbCurrent:function(){var a=c.settings[1],f=c.dbStore();f&&f.put({id:"_current",title:a.hashquery?h.location.href:h.location.href.replace(/#.*/,"")})},dbVersion:function(a){var f=c.dbStore();f&&f.put({id:"_version",title:a})},dbTitle:function(a,f){var k=c.settings[1],h=c.dbStore();h&&(k.hashquery||(a=a.replace(/#.*/,"")),f?h.get(a).onsuccess=function(){h.put(m.extend(!0,{},this.result||{},{id:a,title:f,date:k.timestamp}));c.dbClean(h)}:h.get(a).onsuccess=function(){this.result&&
this.result.title&&(z.title=this.result.title)})},dbScroll:function(a,f){var k=c.settings[1],n=c.dbStore(),d=k.location.href,b=arguments.length;k.scroll.record&&n&&(k.hashquery||(d=d.replace(/#.*/,"")),n.get("_current").onsuccess=function(){this.result&&this.result.title&&d===this.result.title&&(b?n.get(d).onsuccess=function(){n.put(m.extend(!0,{},this.result||{},{scrollX:parseInt(Number(a),10),scrollY:parseInt(Number(f),10)}))}:n.get(d).onsuccess=function(){this.result&&isFinite(this.result.scrollX)&&
isFinite(this.result.scrollY)&&h.scrollTo(parseInt(Number(this.result.scrollX),10),parseInt(Number(this.result.scrollY),10))})})},dbClean:function(a){var f=c.settings[1],k=h.IDBKeyRange||h.webkitIDBKeyRange||h.mozIDBKeyRange||h.msIDBKeyRange;a.count().onsuccess=function(){1E3<this.result&&(a.index("date").openCursor(k.upperBound(f.timestamp-2592E5)).onsuccess=function(){var c=this.result;c?(c["delete"](c.value.id),c["continue"]()):a.count().onsuccess=function(){1E3<this.result&&a.clear()}})}},share:function(){var a=
c.settings[1];m.falsandtru||(m.fn.falsandtru=m.falsandtru=c.falsandtru);m.falsandtru("share","history",a.history);a.history=m.falsandtru("share","history")},falsandtru:function(a,c,k){var h;switch(!0){case c===v:h=m.falsandtru[a];break;case k===v:h=a in m.falsandtru?m.falsandtru[a][c]:v;break;case k!==v:m.falsandtru[a]instanceof Object||(m.falsandtru[a]={}),m.falsandtru[a][c]instanceof Object&&k instanceof Object?m.extend(!0,m.falsandtru[a][c],k):m.falsandtru[a][c]=k,h=m.falsandtru[a][c]}return h}};
(function(a,c,k,h,d){a.fn[d.name]=a[d.name]=function(){return C.apply(this,[a,c,k,h,d].concat([].slice.call(arguments)))};d.setProperties.call(a[d.name])}).apply(this,[].slice.call(arguments).concat([c]))})(jQuery,window,document,void 0);
