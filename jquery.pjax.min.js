/*
 * 
 * pjax
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT http://opensource.org/licenses/mit-license.php
 * @version 1.34.3
 * @updated 2014/06/07
 * @author falsandtru https://github.com/falsandtru/
 * @Compressor Closure Compiler
 */
(function(n,l,A,D){function G(b,d,g,r,f,a){var k=this;switch(!0){case "object"===typeof a:k=k instanceof b?k:b(g);k=f.setProperties.call(k,a.ns||"",null);if(!a.area&&!a.scope)return k;break;default:return k=k instanceof b?k:b[f.name],f.setProperties.call(k,null,null)}var m;m=b.extend(!0,{id:0,gns:f.name,ns:null,area:"body",link:"a:not([target])",filter:function(){return/(\/[^.]*|\.html?|\.php)([#?].*)?$/.test(this.href)},form:null,scope:null,state:null,scrollTop:0,scrollLeft:0,ajax:{dataType:"text"},
contentType:"text/html",cache:{click:!1,submit:!1,popstate:!1,get:!0,post:!0,mix:!1,page:100,size:1048576,expires:{max:null,min:3E5}},callback:function(){},callbacks:{ajax:{},update:{redirect:{},url:{},title:{},head:{},content:{},scroll:{},css:{},script:{},cache:{load:{},save:{}},rendering:{},verify:{}},async:!1},parameter:null,load:{css:!1,script:!1,execute:!0,reload:'[href^="chrome-extension://"]',reject:"",head:"link, meta, base",sync:!0,ajax:{dataType:"script",cache:!0},rewrite:null,redirect:!0},
interval:300,wait:0,scroll:{delay:300},fix:{location:!0,history:!0,scroll:!0,reset:!1},hashquery:!1,fallback:!0,database:!0,server:{query:"pjax=1"}},a);m.location=b("<a/>",{href:f.canonicalizeURL(d.location.href)})[0];m.destination=b("<a/>",{href:f.canonicalizeURL(d.location.href)})[0];m=m.scope&&f.scope(m)||m;m.nss={array:[f.name].concat(m.ns&&String(m.ns).split(".")||[])};b.extend(!0,m,{nss:{name:m.ns||"",event:m.nss.array.join("."),alias:f.alias?[f.alias].concat(m.nss.array.slice(1)).join("."):
!1,click:["click"].concat(m.nss.array.join(":")).join("."),submit:["submit"].concat(m.nss.array.join(":")).join("."),popstate:["popstate"].concat(m.nss.array.join(":")).join("."),scroll:["scroll"].concat(m.nss.array.join(":")).join("."),data:m.nss.array.join("-"),class4html:m.nss.array.join("-"),requestHeader:["X",m.nss.array[0].replace(/^\w/,function(a){return a.toUpperCase()})].join("-")},areas:null,areaback:null,fix:/touch|tablet|mobile|phone|android|iphone|ipad|blackberry/i.test(d.navigator.userAgent)?
{}:{location:!1,reset:!1},contentType:m.contentType.replace(/\s*[,;]\s*/g,"|").toLowerCase(),scroll:{record:!0,queue:[]},log:{script:{},speed:{}},history:{order:[],data:{},size:0},timeStamp:(new Date).getTime(),disable:!1,landing:f.canonicalizeURL(d.location.href),retry:!0,xhr:null,speed:{now:function(){return(new Date).getTime()}},option:a});f.supportPushState()&&b(function(){f.registrate.call(k,b,d,g,r,f,m)});return k}var h;h={name:"pjax",alias:"",ids:[],settings:[0],count:0,setAlias:function(b){h.alias=
"string"===typeof b?b:h.alias;h.name===h.alias||n[h.alias]||(n[h.name][h.alias]=n.fn[h.name],n.fn[h.alias]=n[h.alias]=n.fn[h.name])},IDBFactory:l.indexedDB||l.webkitIndexedDB||l.mozIndexedDB||l.msIndexedDB,IDBDatabase:null,IDBKeyRange:l.IDBKeyRange||l.webkitIDBKeyRange||l.mozIDBKeyRange||l.msIDBKeyRange,createHTMLDocument:null,setProperties:function(b,d){var g=this;if(g instanceof n||g===n[h.name])g=g instanceof n&&d!==D?g.add(d):g,g[h.name]=n[h.name],g.on=function(){h.settings[1].disable=!1},g.off=
function(){h.settings[1].disable=!0},g.click=function(b,f){var a;switch(!0){case "object"===typeof b:a=n(b);break;case !!b:f=f||{};f.href=b;a=n("<a/>",f);break;default:return this}return a.first().one("click",1,h.click).click()},g.submit=function(b,f,a){var d=A.createDocumentFragment(),m;switch(!0){case "object"===typeof b:f=n(b);break;case !!a:f=f||{};f.action=b;b=a instanceof Array&&Array||a instanceof Object&&Object||D;for(var e in a){m=a[e];switch(b){case Object:m=n("<textarea/>",{name:e}).val(m);
break;case Array:m.attr=m.attr||{};m.attr.name=m.name;m=n(m.tag.indexOf("<")?"<"+m.tag+"/>":m.tag,m.attr||{}).val(m.value);break;default:continue}d.appendChild(m[0])}f=n("<form/>",f).append(d);break;default:return this}return f.first().one("submit",1,h.submit).submit()},g.setCache=function(b,f,a,d){var m=h.settings[1];if(!m||!m.history)return this;var e,g,s,t,p;e=m.history;b=h.canonicalizeURL(b||l.location.href);b=m.hashquery?b:b.replace(/#.*/,"");switch(arguments.length){case 0:return f=h.trim(A.documentElement.outerHTML),
arguments.callee.call(this,b,f);case 1:return arguments.callee.call(this,b,null);default:e.order.unshift(b);for(g=1;s=e.order[g];g++)b===s&&e.order.splice(g,1);e.size>m.cache.size&&n[h.name].cleanCache();n[h.name].getCache(b);s=h.createHTMLDocument(f||(d||{}).responseText||"");g=s.title||"";s=parseInt(1.8*s.documentElement.outerHTML.length||1048576,10);t=(new Date).getTime();(p=m.cache.expires)?e.data[b]&&!d?p=e.data[b].expires:(d&&(/no-store|no-cache/.test(d.getResponseHeader("Cache-Control"))||
(p=~String(p=d.getResponseHeader("Cache-Control")).indexOf("max-age=")?1E3*p.match(/max-age=(\d+)/)[1]:(p=d.getResponseHeader("Expires"))?(new Date(p)).getTime()-(new Date).getTime():m.cache.expires)),p=Math.max(p,0)||0,p="object"===typeof m.cache.expires&&"number"===typeof m.cache.expires.min?Math.max(m.cache.expires.min,p):p,p="object"===typeof m.cache.expires&&"number"===typeof m.cache.expires.max?Math.min(m.cache.expires.max,p):p,p=t+p):p=0;e.size=e.size||0;e.size+=e.data[b]?0:s;e.data[b]=n.extend(!0,
e.data[b]||{},{XMLHttpRequest:d,textStatus:a,data:f,size:s,expires:p,timeStamp:t});e.data[b].data||e.data[b].XMLHttpRequest||n[h.name].removeCache(b);m.database&&m.fix.history&&h.dbTitle(b,g)}return this},g.getCache=function(b){var f=h.settings[1];if(!f||!f.history)return!1;var a;a=f.history;b=h.canonicalizeURL(b||l.location.href);b=f.hashquery?b:b.replace(/#.*/,"");a.data[b]&&(new Date).getTime()>a.data[b].expires&&n[h.name].removeCache(b);a.data[b]&&!a.data[b].data&&!a.data[b].XMLHttpRequest&&n[h.name].removeCache(b);
return a.data[b]},g.removeCache=function(b){var f=h.settings[1];if(!f||!f.history)return this;var a;a=f.history;b=h.canonicalizeURL(b||l.location.href);b=f.hashquery?b:b.replace(/#.*/,"");for(var f=0,d;d=a.order[f];f++)b===d&&(a.order.splice(f,1),a.size-=a.data[d].size,a.data[d]=null,delete a.data[d]);return this},g.clearCache=function(){var b=h.settings[1];if(!b||!b.history)return this;for(var b=b.history,f=b.order.length,a;a=b.order[--f];)b.order.splice(f,1),b.size-=b.data[a].size,delete b.data[a];
return this},g.cleanCache=function(){var b=h.settings[1];if(!b||!b.history)return this;for(var f=b.history,a=f.order.length,d;d=f.order[--a];)if(a>=b.cache.page||d in f.data&&(new Date).getTime()>f.data[d].expires)f.order.splice(a,1),f.size-=f.data[d].size,delete f.data[d];return this},g.follow=function(b,f,a){var d=h.settings[1];if(!d||!n.when||!h.check(b,d))return!1;isFinite(b.timeStamp)&&(f.timeStamp=a||b.timeStamp);d.xhr=f;n.when(f).done(function(){d.xhr&&4>d.xhr.readyState&&d.xhr.abort();n[h.name].setCache(b.currentTarget.href,
D,D,f)}).fail(function(){h.fallback(b)});n[h.name].click(b.currentTarget.href);return!0};return g},check:function(b,d){var g,r;g=n("<a/>",{href:h.canonicalizeURL(l.location.href)})[0];r=n("<a/>",{href:h.canonicalizeURL(b.currentTarget.href)})[0];if(n(b.currentTarget).filter(d.filter).length&&!(d.disable||g.protocol!==r.protocol||g.host!==r.host||1<b.which||b.metaKey||b.ctrlKey||b.shiftKey||b.altKey)&&(d=n.extend(!0,{},d),d.area=d.option.area,d=d.scope?h.scope(d,g.href,r.href):d)&&(d.area=h.fire(d.area,
null,[b,d.parameter,r.href,g.href]),d.areas=d.areas||h.chooseAreas(A,b,d.area),d.areaback=d.area,d.area=d.areas[0],d.area))return!0},supportPushState:function(){return"pushState"in l.history&&l.history.pushState},registrate:function(b,d,g,h,f,a){var k=function(a){try{var e=a&&a('<html lang="en" class="html a b"><head><noscript><style>/**/</style></noscript></head><body><noscript>noscript</noscript></body></html>');return e&&b("html",e).is(".html[lang=en]")&&b("head>noscript",e).html()&&"noscript"===
b("body>noscript",e).text()}catch(f){}};f.createHTMLDocument=function(b){return d.DOMParser&&d.DOMParser.prototype&&(new d.DOMParser).parseFromString(b||"","text/html")};if(!k(f.createHTMLDocument)&&(f.createHTMLDocument=function(b){b=b||"";if(g.implementation&&g.implementation.createHTMLDocument){for(var a=g.implementation.createHTMLDocument(""),f=g.createElement("html"),d=(b.slice(0,1024).match(/<html ([^>]+)>/im)||[0,""])[1].match(/\w+\="[^"]*.|\w+\='[^']*.|\w+/gm)||[],h=0,k;k=d[h];h++)k=k.split("=",
2),a.documentElement.setAttribute(k[0],k[1].replace(/^["']|["']$/g,""));f.innerHTML=b.replace(/^.*?<html[^>]*>|<\/html>.*$/ig,"");a.documentElement.removeChild(a.head);a.documentElement.removeChild(a.body);for(h=0;b=f.childNodes[h];h)a.documentElement.appendChild(b)}return a},!k(f.createHTMLDocument)&&(f.createHTMLDocument=function(b){b=b||"";if(g.implementation&&g.implementation.createHTMLDocument){var a=g.implementation.createHTMLDocument("");"object"===typeof a.activeElement&&(a.open(),a.write(b),
a.close())}return a},!k(f.createHTMLDocument))))return;a.id=1;f.ids.push(a.id);f.settings[a.id]=a;a.load.script&&b("script").each(function(){var d=this,e,d="function"===typeof a.load.rewrite?f.fire(a.load.rewrite,null,[d.cloneNode()])||d:d;e=d.src;e in a.log.script||!e||a.load.reload&&b(d).is(a.load.reload)||(a.log.script[e]=!0)});a.database&&(f.database(),a.fix.scroll&&b(d).unbind(a.nss.scroll).bind(a.nss.scroll,a.id,function(a,e){var g=f.settings[1],h;if(g.scroll.delay){for(;h=g.scroll.queue.shift();)clearTimeout(h);
h=setTimeout(function(){for(;h=g.scroll.queue.shift();)clearTimeout(h);f.dbScroll(b(d).scrollLeft(),b(d).scrollTop())},g.scroll.delay);g.scroll.queue.push(h)}else f.dbScroll(b(d).scrollLeft(),b(d).scrollTop())}));a.link&&b(this).undelegate(a.link,a.nss.click).delegate(a.link,a.nss.click,a.id,f.click=function(a){a.timeStamp=(new Date).getTime();var e=f.settings[1];if(!(!b(this).filter(e.filter).length||e.disable||a.isDefaultPrevented()||(e.location.href=f.canonicalizeURL(d.location.href),e.destination.href=
f.canonicalizeURL(this.href),e.location.protocol!==e.destination.protocol||e.location.host!==e.destination.host||1<a.which||a.metaKey||a.ctrlKey||a.shiftKey||a.altKey||!e.hashquery&&e.destination.hash&&e.location.href.replace(/#.*/,"")===e.destination.href.replace(/#.*/,"")))){var k,n;k=e.destination.href;e.timeStamp=a.timeStamp;e.landing&&(e.landing=!1);if(!e.cache.mix||!b[f.name].getCache(k))if(e=e.scope?f.scope(e,e.location.href,e.destination.href):e)if(e.area=f.fire(e.area,null,[a,e.parameter,
e.destination.href,e.location.href]),e.areas=e.areas||f.chooseAreas(g,a,e.area,e.parameter,e.destination.href,e.location.href),e.areaback=e.area,e.area=e.areas[0],e.area)return e.database&&f.dbScroll(b(d).scrollLeft(),b(d).scrollTop()),e.cache[a.type.toLowerCase()]&&(n=b[f.name].getCache(k)),f.drive(b,d,g,h,f,e,a,k,!0,n),a.preventDefault()}});a.form&&b(this).undelegate(a.form,a.nss.submit).delegate(a.form,a.nss.submit,a.id,f.submit=function(a){a.timeStamp=(new Date).getTime();var e=f.settings[1];
if(!(e.disable||a.isDefaultPrevented()||(e.location.href=f.canonicalizeURL(d.location.href),e.destination.href=f.canonicalizeURL(this.action),e.location.protocol!==e.destination.protocol||e.location.host!==e.destination.host||1<a.which||a.metaKey||a.ctrlKey||a.shiftKey||a.altKey))){var k,n;k=e.destination.href=f.canonicalizeURL(e.destination.href.replace(/[?#].*/,"")+("GET"===a.target.method.toUpperCase()?"?"+b(a.target).serialize():""));e.timeStamp=a.timeStamp;e.landing&&(e.landing=!1);if(!e.cache.mix||
!b[f.name].getCache(k))if(e=e.scope?f.scope(e,e.location.href,e.destination.href):e)if(e.area=f.fire(e.area,null,[a,e.parameter,e.destination.href,e.location.href]),e.areas=e.areas||f.chooseAreas(g,a,e.area,e.parameter,e.destination.href,e.location.href),e.areaback=e.area,e.area=e.areas[0],e.area)return e.database&&f.dbScroll(b(d).scrollLeft(),b(d).scrollTop()),e.cache[a.type.toLowerCase()]&&e.cache[a.target.method.toLowerCase()]&&(n=b[f.name].getCache(k)),f.drive(b,d,g,h,f,e,a,k,!0,n),a.preventDefault()}});
b(d).unbind(a.nss.popstate).bind(a.nss.popstate,a.id,f.popstate=function(a){a.timeStamp=(new Date).getTime();var e=f.settings[1];if(!e.disable&&!a.isDefaultPrevented()){e.destination.href=f.canonicalizeURL(d.location.href);if(e.location.href===e.destination.href)return a.preventDefault();var k,n;if(e.location.hash!==e.destination.hash&&e.location.pathname+e.location.search===e.destination.pathname+e.destination.search&&!e.hashquery)return a.preventDefault();k=e.destination.href;e.timeStamp=a.timeStamp;
if(e.landing){if(e.landing.href===k){e.landing=!1;return}e.landing=!1}if(!e.cache.mix||!b[f.name].getCache(k))if(e=e.scope?f.scope(e,e.location.href,e.destination.href):e)if(e.area=f.fire(e.area,null,[a,e.parameter,e.destination.href,e.location.href]),e.areas=e.areas||f.chooseAreas(g,a,e.area,e.parameter,e.destination.href,e.location.href),e.areaback=e.area,e.area=e.areas[0],e.area)return e.database&&e.fix.history&&f.dbTitle(k),e.cache[a.type.toLowerCase()]&&(n=b[f.name].getCache(k)),f.drive(b,d,
g,h,f,e,a,k,!1,n),a.preventDefault()}})},drive:function(b,d,g,h,f,a,k,m,e,n){function s(a,b,d,f,g,c,h,k){a:{var n=c.speedcheck;n&&c.log.speed.time.push(c.speed.now()-c.log.speed.fire);n&&c.log.speed.name.push("loaded("+c.log.speed.time[c.log.speed.time.length-1]+")");var r=c.callbacks.update;if(!1!==g.fire(r.before,null,[h,c.parameter,v,w,q,k],c.callbacks.async)){if(c.cache.mix&&"popstate"!==h.type.toLowerCase()&&(new Date).getTime()-h.timeStamp<=c.cache.mix)return"function"===typeof c.fallback?g.fire(c.fallback,
null,[h,c.parameter,c.destination.href,c.location.href]):g.fallback(h);var p,s,l,t;try{c.xhr&&4>c.xhr.readyState&&c.xhr.abort();c.xhr=null;if(!k&&!~(q.getResponseHeader("Content-Type")||"").toLowerCase().search(c.contentType))throw Error("throw: content-type mismatch");k&&!1!==g.fire(r.cache.load.before,null,[h,c.parameter,k],c.callbacks.async)&&(q=k.XMLHttpRequest||q,v=q.responseText,w=k.textStatus||w,l=k.css,t=k.script,g.fire(r.cache.load.after,null,[h,c.parameter,k],c.callbacks.async));k&&k.XMLHttpRequest||
!c.cache.click&&!c.cache.submit&&!c.cache.popstate||"submit"===h.type.toLowerCase()&&!c.cache[h.target.method.toLowerCase()]||!1===g.fire(r.cache.save.before,null,[h,c.parameter,k],c.callbacks.async)||(a[g.name].setCache(m,k&&k.data||null,w,q),k=a[g.name].getCache(m),g.fire(r.cache.save.after,null,[h,c.parameter,k],c.callbacks.async));var u,y,z,E;u=g.createHTMLDocument(q.responseText);var D=g.chooseAreas(u,h,c.areaback,c.parameter,c.destination.href,c.location.href);c.areas=a.map(c.areas,function(b){return~a.inArray(b,
D)?b:null});c.area=c.areas[0];if(!c.area||a(c.area).length!==a(c.area,u).length)throw Error("throw: area length mismatch");p=a("title",u).text();z=c.area.match(/(?:[^,\(\[]+|\(.*?\)|\[.*?\])+/g);if(k&&k.data){y=g.createHTMLDocument(k.data);for(var H=0,I,A,K;I=z[H++];){A=a(I,u);K=a(I,y);for(var F=0;x=K[F];F++)A.eq(F).html(a(x).contents())}}a("noscript",u).children().parent().each(function(){this.children.length&&a(this).text(this.innerHTML)});a(b).trigger(c.gns+".unload");var B=a('head meta[http-equiv="Refresh"][content*="URL="]',
u);if(B[0]&&!1!==g.fire(r.redirect.before,null,[h,c.parameter,v,w,q],c.callbacks.async)){B=a("<a>",{href:B.attr("content").match(/\w+:\/\/[^;\s]+/i)})[0];switch(!0){case !c.load.redirect:case B.protocol!==c.destination.protocol:case B.host!==c.destination.host:case "submit"===h.type.toLowerCase()&&"GET"===h.target.method.toUpperCase():switch(h.type.toLowerCase()){case "click":case "submit":return b.location.assign(B.href);case "popstate":return b.location.replace(B.href)}default:switch(a[g.name].on(),
h.type.toLowerCase()){case "click":return a[g.name].click(B.href);case "submit":return"GET"===h.target.method.toUpperCase()?a[g.name].click(B):b.location.assign(B.href);case "popstate":return b.history.replaceState(b.history.state,p,B.href),e&&c.fix.location&&(a[g.name].off(),b.history.back(),b.history.forward(),a[g.name].on()),a(b).trigger("popstate")}}g.fire(r.redirect.after,null,[h,c.parameter,v,w,q],c.callbacks.async)}!1!==g.fire(r.url.before,null,[h,c.parameter,v,w,q],c.callbacks.async)&&(e&&
m!==c.location.href&&b.history.pushState(g.fire(c.state,null,[h,c.parameter,c.destination.href,c.location.href]),b.opera||~b.navigator.userAgent.toLowerCase().indexOf("opera")?p:d.title,m),c.location.href=m,e&&c.fix.location&&(a[g.name].off(),b.history.back(),b.history.forward(),a[g.name].on()),g.fire(r.url.after,null,[h,c.parameter,v,w,q],c.callbacks.async));!1!==g.fire(r.title.before,null,[h,c.parameter,v,w,q],c.callbacks.async)&&(d.title=p,c.database&&c.fix.history&&g.dbTitle(m,p),g.fire(r.title.after,
null,[h,c.parameter,v,w,q],c.callbacks.async));c.database&&g.dbCurrent();if(!1!==g.fire(r.head.before,null,[h,c.parameter,v,w,q],c.callbacks.async)){var J=[],N=a("head").find(c.load.head).not('link[rel~="stylesheet"], style, script');s=a("head",u).find(c.load.head).not(a(c.area,u).find(c.load.head));s=a(s).not(c.load.reject).not('link[rel~="stylesheet"], style, script');for(var C,H=0,x;x=s[H];H++){x="object"===typeof x?x:a(x)[0];switch(x.tagName.toLowerCase()){case "base":C="base";break;case "link":C=
'link[rel="'+x.getAttribute("rel")+'"]';switch((x.getAttribute("rel")||"").toLowerCase()){case "alternate":C+='[type="'+x.getAttribute("type")+'"]'}break;case "meta":if(x.getAttribute("charset"))C="meta[charset]";else if(x.getAttribute("http-equiv"))C='meta[http-equiv="'+x.getAttribute("http-equiv")+'"]';else if(x.getAttribute("name"))C='meta[name="'+x.getAttribute("name")+'"]';else if(x.getAttribute("property"))C='meta[property="'+x.getAttribute("property")+'"]';else continue;break;default:C=null}J=
s.filter(C).not('link[rel~="stylesheet"], style, script');a("head").find(C).not(c.load.reload).not('link[rel~="stylesheet"], style, script').filter(function(){var a=this,b;return!!J.filter(function(){b=this;return a.outerHTML===b.outerHTML?(J=J.not(b),N=N.not(a),!1):!0})[0]}).remove();a("head").prepend(J.map(function(){return a(this.outerHTML)[0]}))}N.not(c.load.reload).remove();g.fire(r.head.after,null,[h,c.parameter,v,w,q],c.callbacks.async)}n&&c.log.speed.time.push(c.speed.now()-c.log.speed.fire);
n&&c.log.speed.name.push("head("+c.log.speed.time[c.log.speed.time.length-1]+")");if(!1!==g.fire(r.content.before,null,[h,c.parameter,v,w,q],c.callbacks.async)){a(c.area).children("."+c.nss.class4html+"-check").remove();E=a("<div/>",{"class":c.nss.class4html+"-check",style:"background: none !important; display: block !important; visibility: hidden !important; position: absolute !important; top: 0 !important; left: 0 !important; z-index: -9999 !important; width: auto !important; height: 0 !important; margin: 0 !important; padding: 0 !important; border: none !important; font-size: 12px !important; text-indent: 0 !important;"}).text(c.gns);
for(H=0;I=z[H++];)for(A=a(I),K=a(I,u).clone().find("script").remove().end(),F=0;x=K[F];F++)A.eq(F).html(a(x).contents()).append(E.clone());E=a(c.area).children("."+c.nss.class4html+"-check");a(d).trigger(c.gns+".DOMContentLoaded");g.fire(r.content.after,null,[h,c.parameter,v,w,q],c.callbacks.async)}n&&c.log.speed.time.push(c.speed.now()-c.log.speed.fire);n&&c.log.speed.name.push("content("+c.log.speed.time[c.log.speed.time.length-1]+")");var O=function(e){if(!1!==g.fire(r.scroll.before,null,[h,c.parameter],
c.callbacks.async)){var d,f;switch(h.type.toLowerCase()){case "click":case "submit":d=e&&"function"===typeof c.scrollLeft?g.fire(c.scrollLeft,null,[h,c.parameter,c.destination.href,c.location.href]):c.scrollLeft;d=0<=d?d:0;d=!1===d||null===d?a(b).scrollLeft():parseInt(Number(d),10);f=e&&"function"===typeof c.scrollTop?g.fire(c.scrollTop,null,[h,c.parameter,c.destination.href,c.location.href]):c.scrollTop;f=0<=f?f:0;f=!1===f||null===f?a(b).scrollTop():parseInt(Number(f),10);a(b).scrollTop()===f&&a(b).scrollLeft()===
d||b.scrollTo(d,f);e&&c.database&&c.fix.scroll&&g.dbScroll(d,f);break;case "popstate":e&&c.database&&c.fix.scroll&&g.dbScroll()}g.fire(r.scroll.after,null,[h,c.parameter],c.callbacks.async)}},P=function(b){if(!1!==g.fire(r.rendering.before,null,[h,c.parameter],c.callbacks.async)){var d=0;(function(){E.filter(function(){return this.clientWidth||this.clientHeight||a(this).is(":hidden")}).length===E.length||100<=d?G(b):E.length&&(d++,setTimeout(arguments.callee,c.interval))})()}},G=function(d){n&&c.log.speed.time.push(c.speed.now()-
c.log.speed.fire);n&&c.log.speed.name.push("renderd("+c.log.speed.time[c.log.speed.time.length-1]+")");E.remove();c.scroll.record=!0;g.hashscroll("popstate"===h.type.toLowerCase())||O(!0);a(b).trigger(c.gns+".load");g.fire(d);n&&console.log(c.log.speed.time);n&&console.log(c.log.speed.name);g.fire(r.rendering.after,null,[h,c.parameter],c.callbacks.async)};a("noscript",u).remove();var M=function(d){if(c.load.script&&!1!==g.fire(r.script.before,null,[h,c.parameter,v,w,q],c.callbacks.async)){var f,e=
[];f=(k=a[g.name].getCache(m))&&!k.script;t=t||a("script",u);t=a(t).not(c.load.reject);k&&k.script&&t&&t.length!==k.script.length&&(f=!0);f&&(k.script=[]);for(var p=0,l;l=t[p];p++)l="object"===typeof l?f?a(l.outerHTML)[0]:l:a(l)[0],l="function"===typeof c.load.rewrite?g.fire(c.load.rewrite,null,[l])||l:l,f&&(k.script[p]=l),!a(l).is(d)||!l.src&&!g.trim(l.innerHTML)||l.src in c.log.script||c.load.reject&&a(l).is(c.load.reject)||(c.load.reload&&a(l).is(c.load.reload)||(c.log.script[l.src]=!0),l&&e.push(l));
for(p=0;l=e[p];p++)try{l.src?a.ajax(a.extend(!0,{},c.ajax,c.load.ajax,{url:l.src,async:!!l.async,global:!1})):"object"!==typeof l||l.type&&!~l.type.toLowerCase().indexOf("text/javascript")||b.eval.call(b,(l.text||l.textContent||l.innerHTML||"").replace(/^\s*<!(?:\[CDATA\[|\-\-)/,"/*$0*/"))}catch(s){break}!1!==g.fire(r.script.after,null,[h,c.parameter,v,w,q],c.callbacks.async)&&(n&&c.log.speed.time.push(c.speed.now()-c.log.speed.fire),n&&c.log.speed.name.push(("[src][defer]"===d?"defer":"script")+
"("+c.log.speed.time[c.log.speed.time.length-1]+")"))}};g.fire(r.verify.before,null,[h,c.parameter],c.callbacks.async);var Q=g.canonicalizeURL(b.location.href).replace(/(?:%\w{2})+/g,function(a){return m.match(a.toLowerCase())||a});if(m===Q)c.retry=!0,c.area=c.option.area,c.areas=D;else if(c.retry)c.retry=!1,c.destination.href=Q,g.drive(a,b,d,f,g,c,h,c.destination.href,!1,c.cache[h.type.toLowerCase()]&&a[g.name].getCache(g.canonicalizeURL(b.location.href)));else throw Error("throw: location mismatch");
g.fire(r.verify.after,null,[h,c.parameter],c.callbacks.async);(function(b){if(c.load.css&&!1!==g.fire(r.css.before,null,[h,c.parameter,v,w,q],c.callbacks.async)){var d,f=[],e=a(b).not(a(c.area).find(b));d=(k=a[g.name].getCache(m))&&!k.css;l=l||a(b,u).not(a(c.area,u).find(b));l=a(l).not(c.load.reject);k&&k.css&&l&&l.length!==k.css.length&&(d=!0);d&&(k.css=[]);for(var p=0,s;s=l[p];p++){s="object"===typeof s?d?a(s.outerHTML)[0]:s:a(s)[0];s="function"===typeof c.load.rewrite?g.fire(c.load.rewrite,null,
[s])||s:s;d&&(k.css[p]=s);for(var t=0;e[t];t++)if(g.trim(e[t].href||e[t].innerHTML||"")===g.trim(s.href||s.innerHTML||"")){f.length&&(s=e.eq(t).prevAll(b).first(),s[0]?s.after(f):e.eq(t).before(f),f=[]);e=e.not(e[t]);s=null;break}s&&f.push(s.cloneNode(!0))}e[0]?e.last().after(f):a("head").append(f);e.not(c.load.reload).remove();!1!==g.fire(r.css.after,null,[h,c.parameter,v,w,q],c.callbacks.async)&&(n&&c.log.speed.time.push(c.speed.now()-c.log.speed.fire),n&&c.log.speed.name.push("css("+c.log.speed.time[c.log.speed.time.length-
1]+")"))}})('link[rel~="stylesheet"], style');a(b).one(c.gns+".rendering",function(b){b.preventDefault();b.stopImmediatePropagation();O(!1);a(d).trigger(c.gns+".ready");M(":not([defer]), :not([src])");c.load.sync?P(function(){M("[src][defer]")}):(P(),M("[src][defer]"))}).trigger(c.gns+".rendering");if(!1===g.fire(r.success,null,[h,c.parameter,v,w,q],c.callbacks.async))break a;if(!1===g.fire(r.complete,null,[h,c.parameter,v,w,q],c.callbacks.async))break a;if(!1===g.fire(c.callback,null,[h,c.parameter,
v,w,q],c.callbacks.async))break a}catch(R){k&&a[g.name].removeCache(m);if(!1===g.fire(r.error,null,[h,c.parameter,v,w,q],c.callbacks.async))break a;if(!1===g.fire(r.complete,null,[h,c.parameter,v,w,q],c.callbacks.async))break a;if(c.fallback)return"function"===typeof c.fallback?g.fire(c.fallback,null,[h,c.parameter,c.destination.href,c.location.href]):g.fallback(h)}g.fire(r.after,null,[h,c.parameter,v,w,q],c.callbacks.async)}}}var t=a.speedcheck;t&&(a.log.speed.fire=a.timeStamp);t&&(a.log.speed.time=
[]);t&&(a.log.speed.name=[]);t&&a.log.speed.time.push(0);t&&a.log.speed.name.push("pjax("+a.log.speed.time[a.log.speed.time.length-1]+")");a.scroll.record=!1;a.fix.reset&&/click|submit/.test(k.type.toLowerCase())&&d.scrollTo(b(d).scrollLeft(),0);if(!1!==f.fire(a.callbacks.before,null,[k,a.parameter],a.callbacks.async)){b[f.name].off();if(n&&n.XMLHttpRequest)t&&a.log.speed.name.splice(0,1,"cache("+a.log.speed.time[a.log.speed.time.length-1]+")"),b.when?b.when(f.wait(f.fire(a.wait,null,[k,a.parameter,
a.destination.href,a.location.href]))).done(function(){s(b,d,g,h,f,a,k,n)}):s(b,d,g,h,f,a,k,n);else if(a.xhr&&a.xhr.promise)t&&a.log.speed.time.splice(0,1,a.xhr.timeStamp-a.log.speed.fire),t&&a.log.speed.name.splice(0,1,"preload("+a.log.speed.time[a.log.speed.time.length-1]+")"),t&&a.log.speed.time.push(a.speed.now()-a.log.speed.fire),t&&a.log.speed.name.push("continue("+a.log.speed.time[a.log.speed.time.length-1]+")"),t=a.wait&&isFinite(a.xhr.timeStamp)?Math.max(a.wait-(new Date).getTime()+a.xhr.timeStamp,
0):0,b.when(a.xhr,f.wait(t)).done(function(){s(b,d,g,h,f,a,k,b[f.name].getCache(m))});else{var p,l,v,q,w,z;p={};switch(k.type.toLowerCase()){case "click":p.type="GET";break;case "submit":p.type=k.target.method.toUpperCase();"POST"===p.type&&(p.data=b(k.target).serializeArray());break;case "popstate":p.type="GET"}l=b.when?b.Deferred():null;b.extend(!0,p,a.ajax,{xhr:a.callbacks.ajax.xhr?function(){q=f.fire(a.callbacks.ajax.xhr,this,[k,a.parameter],a.callbacks.async);return q="object"===typeof q&&q||
b.ajaxSettings.xhr()}:h,beforeSend:function(b,d){q=b;a.xhr&&4>a.xhr.readyState&&a.xhr.abort();a.xhr=q;q.setRequestHeader(a.nss.requestHeader,"true");q.setRequestHeader(a.nss.requestHeader+"-Area",a.area);q.setRequestHeader(a.nss.requestHeader+"-CSS",a.load.css);q.setRequestHeader(a.nss.requestHeader+"-Script",a.load.script);f.fire(a.callbacks.ajax.beforeSend,this,[k,a.parameter,q,d],a.callbacks.async)},dataFilter:a.callbacks.ajax.dataFilter?function(b,d){v=b;return f.fire(a.callbacks.ajax.dataFilter,
this,[k,a.parameter,v,d],a.callbacks.async)||v}:h,success:function(b,d,e){v=b;w=d;q=e;f.fire(a.callbacks.ajax.success,this,[k,a.parameter,v,w,q],a.callbacks.async)},error:function(b,d,e){q=b;w=d;z=e;f.fire(a.callbacks.ajax.error,this,[k,a.parameter,q,w,z],a.callbacks.async)},complete:function(e,m){q=e;w=m;f.fire(a.callbacks.ajax.complete,this,[k,a.parameter,q,w],a.callbacks.async);if(z){if(l&&l.reject(),a.fallback&&"abort"!==w)return"function"===typeof a.fallback?f.fire(a.fallback,null,[k,a.parameter,
a.destination.href,a.location.href]):f.fallback(k)}else l&&l.resolve()||s(b,d,g,h,f,a,k,n)}});var y=a.server.query;y&&(y=y.split("="),y=encodeURIComponent(y[0])+(0<y.length?"="+encodeURIComponent(y[1]):""));p.url=m.replace(/([^#]+)(#[^\s]*)?$/,"$1"+(y?(m.match(/\?/)?"&":"?")+y:"")+"$2");t&&a.log.speed.time.push(a.speed.now()-a.log.speed.fire);t&&a.log.speed.name.push("request("+a.log.speed.time[a.log.speed.time.length-1]+")");b.when&&b.when(l.promise(),f.wait(f.fire(a.wait,null,[k,a.parameter,a.destination.href,
a.location.href]))).done(function(){s(b,d,g,h,f,a,k,n)});b.ajax(p)}b[f.name].on();f.fire(a.callbacks.after,null,[k,a.parameter],a.callbacks.async)}},canonicalizeURL:function(b){var d;d=h.trim(b);d=d.replace(/["`^|\\<>{}\[\]\s].*/,"");d=/^https?:/i.test(d)?d:n("<a/>",{href:d})[0].href;d=encodeURI(decodeURI(d));return d=d.replace(/(?:%\w{2})+/g,function(d){return b.match(d.toLowerCase())||d})},trim:function(b){if(String.prototype.trim)b=String(b).trim();else if(b=String(b).replace(/^[\s\uFEFF\xA0]+/,
""))for(var d=b.length;--d;)if(/[^\s\uFEFF\xA0]/.test(b.charAt(d))){b=b.substring(0,d+1);break}return b},chooseAreas:function(b,d,g){g=g instanceof Array?g:[g];return g=n.map(g,function(d){return n(d,b)[0]?d:null})},fire:function(b,d,g,h){return"function"===typeof b?h?setTimeout(function(){b.apply(d,g)},0):b.apply(d,g):b},hashscroll:function(b){var d=h.settings[1].destination.hash.slice(1);return!(b||!d)&&n("#"+(d?d:", [name~="+d+"]")).first().each(function(){isFinite(n(this).offset().top)&&l.scrollTo(n(l).scrollLeft(),
parseInt(Number(n(this).offset().top),10))}).length},wait:function(b){var d=n.Deferred();if(!b)return d.resolve();setTimeout(function(){d.resolve()},b);return d.promise()},fallback:function(b){switch(b.type.toLowerCase()){case "click":l.location.assign(b.currentTarget.href);break;case "submit":b.target.submit();break;case "popstate":l.location.reload()}},scope:function(b,d,g,l){var f,a,k,m,e,u,s,t,p,A,v,q,w;f=[].slice.call(arguments);f.splice(1,1,d||b.location.href);f.splice(2,1,g||b.destination.href);
a=b.scope;d=(d||b.location.href).replace(/.+?\w(\/[^#?]*).*/,"$1");g=(g||b.destination.href).replace(/.+?\w(\/[^#?]*).*/,"$1");k=d.replace(/^\//,"").replace(/([?#])/g,"/$1").split("/");e=(l||d).replace(/^\//,"").replace(/([?#])/g,"/$1").split("/");if(l){if(!~l.indexOf("*"))return D;m=[];for(var z=0,y=e.length;z<y;z++)"*"===e[z]&&m.push(k[z])}for(z=e.length+1;z--;)if(p=A=v=q=D,k=e.slice(0,z).join("/").replace(/\/([?#])/g,"$1"),(k="/"+k+("/"===(l||d).charAt(k.length+1)?"/":""))&&k in a){if(!a[k]||!a[k].length)return!1;
for(var G=0;(u=a[k][G])&&!1!==v&&!1!==q;G++)if("rewrite"!==u||"function"!==typeof a.rewrite||l)if("inherit"===u)A=!0;else if("string"===typeof u){u=(s="^"===u.charAt(0))?u.slice(1):u;u=(t="*"===u.charAt(0))?u.slice(1):u;if(l&&~u.indexOf("/*/"))for(var L=0,y=m.length;L<y;L++)u=u.replace("/*/","/"+m[L]+"/");if(!(!s&&v||(t?d.search(u):d.indexOf(u)))){if(s)return!1;v=!0}if(!(!s&&q||(t?g.search(u):g.indexOf(u)))){if(s)return!1;q=!0}}else"object"===typeof u&&(w=u);else if(f.push(h.fire(a.rewrite,null,[g])),
p=arguments.callee.apply(this,f)){v=q=!0;break}else if(!1===p)return!1;if(v&&q)return n.extend(!0,{},b,("object"===typeof p?p:w)||{});if(!A)break}},database:function(b){var d=h.settings[1],g,r,f,a,k,m;g=d.gns;r=1;f=Math.floor((new Date).getTime()/864E5);a=h.IDBFactory;k=h.IDBDatabase;b=b||0;d.database=!1;if(!a||!g||5<b)return!1;try{var e=function(d){h.IDBDatabase=null;k&&k.close&&k.close();a.deleteDatabase(g);d?setTimeout(function(){h.database(++b)},d):h.database(++b)};r=parseInt(f-f%7+r,10);k=a.open(g);
k.onblocked=function(){};k.onupgradeneeded=function(){var a=this.result;try{for(var b=a.objectStoreNames?a.objectStoreNames.length:0;b--;)a.deleteObjectStore(a.objectStoreNames[b]);a.createObjectStore(d.gns,{keyPath:"id",autoIncrement:!1}).createIndex("date","date",{unique:!1})}catch(e){}};k.onsuccess=function(){try{k=this.result,h.IDBDatabase=k,(m=h.dbStore())?m.get("_version").onsuccess=function(){this.result&&r!==this.result.title?e():(h.dbVersion(r),h.dbCurrent(),h.dbTitle(d.location.href,A.title),
h.dbScroll(n(l).scrollLeft(),n(l).scrollTop()),d.database=!0)}:e()}catch(a){e(1E3)}};k.onerror=function(a){e(1E3)}}catch(u){e(1E3)}},dbStore:function(){for(var b=h.settings[1],d=h.IDBDatabase,g=d&&d.objectStoreNames?d.objectStoreNames.length:0;g--;)if(b.gns===d.objectStoreNames[g])return d&&d.transaction&&d.transaction(b.gns,"readwrite").objectStore(b.gns);return!1},dbCurrent:function(){var b=h.settings[1],d=h.dbStore();if(d){var g;g=h.canonicalizeURL(l.location.href);g=b.hashquery?g:g.replace(/#.*/,
"");d.put({id:"_current",title:g})}},dbVersion:function(b){var d=h.dbStore();d&&d.put({id:"_version",title:b})},dbTitle:function(b,d){var g=h.settings[1],l=h.dbStore();l&&(b=g.hashquery?b:b.replace(/#.*/,""),d?l.get(b).onsuccess=function(){l.put(n.extend(!0,{},this.result||{},{id:b,title:d,date:(new Date).getTime()}));h.dbClean()}:l.get(b).onsuccess=function(){this.result&&this.result.title&&(A.title=this.result.title)})},dbScroll:function(b,d){var g=h.settings[1],r=h.dbStore(),f=g.location.href,
a=arguments.length;g.scroll.record&&r&&(f=g.hashquery?f:f.replace(/#.*/,""),r.get("_current").onsuccess=function(){this.result&&this.result.title&&f===this.result.title&&(a?r.get(f).onsuccess=function(){r.put(n.extend(!0,{},this.result||{},{scrollX:parseInt(Number(b),10),scrollY:parseInt(Number(d),10)}))}:r.get(f).onsuccess=function(){this.result&&isFinite(this.result.scrollX)&&isFinite(this.result.scrollY)&&l.scrollTo(parseInt(Number(this.result.scrollX),10),parseInt(Number(this.result.scrollY),
10))})})},dbClean:function(){var b=h.dbStore();b.count().onsuccess=function(){1E3<this.result&&(b.index("date").openCursor(h.IDBKeyRange.upperBound((new Date).getTime()-2592E5)).onsuccess=function(){var d=this.result;d?(d["delete"](d.value.id),d["continue"]()):b.count().onsuccess=function(){1E3<this.result&&b.clear()}})}}};(function(b,d,g,h,f){b.fn[f.name]=b[f.name]=function(){return G.apply(this,[b,d,g,h,f].concat([].slice.call(arguments)))};f.setProperties.call(b[f.name])}).apply(this,[].slice.call(arguments).concat([h]))})(jQuery,
window,document,void 0);
