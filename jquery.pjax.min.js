/*
 * 
 * pjax
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT http://opensource.org/licenses/mit-license.php
 * @version 1.29.0
 * @updated 2014/01/15
 * @author falsandtru https://github.com/falsandtru/
 * @Compressor Closure Compiler
 */
(function(n,r,A,v){function D(a,f,d,l,e,b){var k=this;switch(!0){case "object"===typeof b:k=k instanceof a?k:a(d);k=e.setProperties.call(k,b.ns||"",null);if(!b.area)return k;break;default:return k=k instanceof a?k:a[e.name],e.setProperties.call(k,null,null)}var c;c=a.extend(!0,{id:0,gns:e.name,ns:null,area:null,link:"a:not([target])",form:null,scope:null,state:null,scrollTop:0,scrollLeft:0,ajax:{},contentType:"text/html",cache:{click:!1,submit:!1,popstate:!1,get:!0,post:!0,length:9,size:1048576,expire:18E5},
callback:function(){},callbacks:{ajax:{},update:{url:{},title:{},content:{},css:{},script:{},cache:{load:{},save:{}},rendering:{},verify:{}},async:!1},parameter:null,load:{css:!1,script:!1,execute:!0,reload:null,reject:null,sync:!0,ajax:{dataType:"script"},rewrite:null},interval:300,wait:0,scroll:{delay:500},fix:{location:!0,history:!0,scroll:!0,reset:!1},hashquery:!1,fallback:!0,database:!0,server:{},location:a("<a/>",{href:e.canonicalizeURL(f.location.href)})[0],destination:a("<a/>",{href:e.canonicalizeURL(f.location.href)})[0],
speedcheck:!1},b);c.nss={array:[e.name].concat(c.ns&&String(c.ns).split(".")||[])};a.extend(!0,c=c.scope&&e.scope(c)||c,{nss:{name:c.ns||"",event:c.nss.array.join("."),alias:e.alias?[e.alias].concat(c.nss.array.slice(1)).join("."):!1,click:["click"].concat(c.nss.array.join(":")).join("."),submit:["submit"].concat(c.nss.array.join(":")).join("."),popstate:["popstate"].concat(c.nss.array.join(":")).join("."),scroll:["scroll"].concat(c.nss.array.join(":")).join("."),data:c.nss.array.join("-"),class4html:c.nss.array.join("-"),
requestHeader:["X",c.nss.array[0].replace(/^\w/,function(a){return a.toUpperCase()})].join("-")},areaback:c.area,fix:/Mobile(\/\w+)? Safari/i.test(f.navigator.userAgent)?{}:{location:!1,reset:!1},contentType:c.contentType.replace(/\s*[,;]\s*/g,"|").toLowerCase(),scroll:{record:!0,queue:[]},database:c.database?f.indexedDB||f.webkitIndexedDB||f.mozIndexedDB||f.msIndexedDB||null:!1,server:{query:c.server.query?c.server.query:c.gns},log:{script:{},speed:{}},history:{config:c.cache,order:[],data:{},size:0},
timestamp:(new Date).getTime(),disable:!1,landing:e.canonicalizeURL(f.location.href),retry:!0,xhr:null,speed:{now:function(){return(new Date).getTime()}},option:b,validator:validator});e.check()&&e.registrate.call(k,a,f,d,l,e,c);return k}var g;g={name:"pjax",alias:"",ids:[0],settings:[0],count:0,parseHTML:null,setAlias:function(a){g.alias="string"===typeof a?a:g.alias;g.name===g.alias||n[g.alias]||(n[g.name][g.alias]=n.fn[g.name],n.fn[g.alias]=n[g.alias]=n.fn[g.name])},setProperties:function(a,f){var d=
this;if(d instanceof n||d===n[g.name])d=d instanceof n&&f!==v?d.add(f):d,d[g.name]=n[g.name],d.on=function(){g.settings[1].disable=!1},d.off=function(){g.settings[1].disable=!0},d.click=function(a,e){e=e||{};return(e.href=a)?n("<a/>",e).one("click",1,g.click).click():!1},d.submit=function(a,e,b){var k=A.createDocumentFragment(),c;switch(!0){case "object"===typeof a:e=n(a);break;case !!b:e=e||{};e.action=a;a=b instanceof Array&&Array||b instanceof Object&&Object||v;for(var m in b){c=b[m];switch(a){case Object:c=
n("<textarea/>",{name:m}).val(c);break;case Array:c.attr=c.attr||{};c.attr.name=c.name;c=n(c.tag.indexOf("<")?"<"+c.tag+"/>":c.tag,c.attr||{}).val(c.value);break;default:continue}k.appendChild(c[0])}e=n("<form/>",e).append(k);break;default:return!1}e.one("submit",1,g.submit).submit();return!0},d.setCache=function(a,e,b,k){var c=g.settings[1],m,f,d;m=c.history;a=a||g.canonicalizeURL(r.location.href);c.hashquery||(a=a.replace(/#.*/,""));switch(arguments.length){case 1:for(f=0;d=m.order[f];f++)a===d&&
(m.order.splice(f,1),m.size-=m.data[d].size,m.data[d]=null,delete m.data[d]);break;case 0:return arguments.callee.call(this,a,g.trim(A.documentElement.outerHTML));default:m.order.unshift(a);for(f=1;d=m.order[f];f++)a===d&&m.order.splice(f,1);m.size>m.config.size&&n[g.name].cleanCache();n[g.name].getCache(a);f=n("<span/>").html(g.find((e||"")+((k||{}).responseText||"")+"<title></title>",/<title[^>]*?>([^<]*?)<\/title>/i).shift()).text();d=parseInt(1.8*((e||"").length+((k||{}).responseText||"").length)||
1048576,10);m.size=m.size||0;m.size+=d;m.data[a]=n.extend(!0,m.data[a]||{},{XMLHttpRequest:k,textStatus:b,data:e,size:d,timestamp:(new Date).getTime()});c.database&&c.fix.history&&g.dbTitle(a,f)}return m.data[a]},d.getCache=function(a){var e=g.settings[1],b;b=e.history;a=a||g.canonicalizeURL(r.location.href);e.hashquery||(a=a.replace(/#.*/,""));b.data[a]&&e.timestamp>b.data[a].timestamp+b.config.expire&&n[g.name].setCache(a);return b.data[a]},d.clearCache=function(){for(var a=g.settings[1].history,
e=a.order.length,b;b=a.order[--e];)a.order.splice(e,1),a.size-=a.data[b].size,delete a.data[b];return!0},d.cleanCache=function(){for(var a=g.settings[1],e=a.history,b=e.order.length,k;k=e.order[--b];)if(b>=e.config.length||k in e.data&&a.timestamp>e.data[k].timestamp+e.config.expire)e.order.splice(b,1),e.size-=e.data[k].size,delete e.data[k];return!0};return d},check:function(){return g.supportPushState()},supportPushState:function(){return"pushState"in r.history&&r.history.pushState},registrate:function(a,
f,d,l,e,b){b.id=1;e.ids.push(b.id);e.settings[b.id]=b;e.share();e.database();b.load.script&&a("script").each(function(){var k=this,c,k="function"===typeof b.load.rewrite?e.fire(b.load.rewrite,null,[k.cloneNode()])||k:k;(c=k.src)&&c in b.log.script||!c||b.load.reload&&a(k).is(b.load.reload)||(b.log.script[c]=!0)});a(this).undelegate(b.link,b.nss.click).delegate(b.link,b.nss.click,b.id,e.click=function(b){b.timeStamp=(new Date).getTime();var c=e.settings[1];if(c.disable||b.isDefaultPrevented())return b.preventDefault();
c.location.href=e.canonicalizeURL(f.location.href);c.destination.href=e.canonicalizeURL(this.href);if(c.location.protocol===c.destination.protocol&&c.location.host===c.destination.host&&!(1<b.which||b.metaKey||b.ctrlKey||b.shiftKey||b.altKey)){if(!e.fire(c.hashquery,null,[b,this.href])&&c.location.pathname+c.location.search===c.destination.pathname+c.destination.search)return c.destination.hash&&e.hashscroll(),b.preventDefault();var m,g;m=c.destination.href;c.area=e.fire(c.areaback,null,[b,m]);c.timestamp=
b.timeStamp;c.landing&&(c.landing=!1);if(a(c.area).length&&(!c.scope||e.scope(c)))return c.cache[b.type.toLowerCase()]&&(g=a[e.name].getCache(m)),e.drive(a,f,d,l,e,c,b,m,!0,g),b.preventDefault()}});a(this).undelegate(b.form,b.nss.submit).delegate(b.form,b.nss.submit,b.id,e.submit=function(b){b.timeStamp=(new Date).getTime();var c=e.settings[1];if(c.disable||b.isDefaultPrevented())return b.preventDefault();c.location.href=e.canonicalizeURL(f.location.href);c.destination.href=e.canonicalizeURL(this.action);
if(!(1<b.which||b.metaKey||b.ctrlKey||b.shiftKey||b.altKey)){var m,g;m=c.destination.href=e.canonicalizeURL(c.destination.href.replace(/[?#].*/,"")+("GET"===b.target.method.toUpperCase()?"?"+a(b.target).serialize():""));c.area=e.fire(c.areaback,null,[b,m]);c.timestamp=b.timeStamp;c.landing&&(c.landing=!1);if(a(c.area).length&&(!c.scope||e.scope(c)))return c.cache[b.type.toLowerCase()]&&c.cache[b.target.method.toLowerCase()]&&(g=a[e.name].getCache(m)),e.drive(a,f,d,l,e,c,b,m,!0,g),b.preventDefault()}});
a(f).unbind(b.nss.popstate).bind(b.nss.popstate,b.id,e.popstate=function(b){b.timeStamp=(new Date).getTime();var c=e.settings[1];if(c.disable||b.isDefaultPrevented())return b.preventDefault();c.destination.href=e.canonicalizeURL(f.location.href);if(c.location.href===c.destination.href)return b.preventDefault();var m,g;if(!e.fire(c.hashquery,null,[b,m])&&c.location.pathname+c.location.search===c.destination.pathname+c.destination.search)return b.preventDefault();m=c.destination.href;c.area=e.fire(c.areaback,
null,[b,m]);c.timestamp=b.timeStamp;if(c.landing){if(c.landing.href===m){c.landing=!1;return}c.landing=!1}if(a(c.area).length)return c.database&&c.fix.history&&e.dbTitle(m),c.cache[b.type.toLowerCase()]&&(g=a[e.name].getCache(m)),e.drive(a,f,d,l,e,c,b,m,!1,g),b.preventDefault()});b.database&&b.fix.scroll&&a(f).unbind(b.nss.scroll).bind(b.nss.scroll,b.id,function(b,c){var m=e.settings[1],d;if(m.scroll.delay){for(;d=m.scroll.queue.shift();)clearTimeout(d);d=setTimeout(function(){for(;d=m.scroll.queue.shift();)clearTimeout(d);
e.dbScroll(a(f).scrollLeft(),a(f).scrollTop())},m.scroll.delay);m.scroll.queue.push(d)}else e.dbScroll(a(f).scrollLeft(),a(f).scrollTop())});(function(){function b(c){try{var e=c&&c("<body><noscript>DOMParser</noscript></body>");return"DOMParser"===a(e).find("noscript").text()}catch(f){}}var c=f.DOMParser;e.parseHTML=function(a){return c&&c.prototype&&(new c).parseFromString(a,"text/html")};b(e.parseHTML)||(e.parseHTML=function(a){var b;d.implementation&&d.implementation.createHTMLDocument&&(b=d.implementation.createHTMLDocument(""),
"object"===typeof b.activeElement&&(b.open(),b.write(a),b.close()));return b},b(e.parseHTML)||(e.parseHTML=!1))})()},drive:function(a,f,d,g,e,b,k,c,m,n){function r(a,b,e,f,d,h,g,k){a:{var n=h.callbacks.update;if(!1!==d.fire(n.before,null,[g,h.parameter,s,t,p,k],h.callbacks.async)){var l,q,u;try{if(!k&&-1===(p.getResponseHeader("Content-Type")||"").toLowerCase().search(h.contentType))throw Error("throw: content-type mismatch");k&&!1!==d.fire(n.cache.load.before,null,[g,h.parameter,k],h.callbacks.async)&&
(p=k.XMLHttpRequest||p,s=p.responseText,t=k.textStatus||t,q=k.css,u=k.script,d.fire(n.cache.load.after,null,[g,h.parameter,k],h.callbacks.async));var w,x,y,v,z,E,C;E=h.area.split(/\s*,\s*/);x=(p.responseText||"").replace(/<noscript[^>]*>(?:.|[\n\r])*?<\/noscript>/gim,function(a){return a.replace(/<script(?:.|[\n\r])*?<\/script>/gim,"")});if(k&&k.data){v=k.data;y=a(d.parseHTML&&v&&d.parseHTML(v)||v);x=x.replace(/<title[^>]*?>([^<]*?)<\/title>/i,function(a){return d.find(v,/(<title[^>]*?>[^<]*?<\/title>)/i).shift()||
a});w=a(d.parseHTML&&x&&d.parseHTML(x)||x);for(var A=0,B,H;B=E[A++];)w.find(B).add(z?"":w.filter(B)).html(y.find(B).add(z?"":y.filter(B)).contents())}else w=a(d.parseHTML&&x&&d.parseHTML(x)||x);switch(!0){case !!w.find("html")[0]:z=1;w.find("noscript").each(function(){this.children.length&&a(this).text(this.innerHTML)});break;case !!w.filter("title")[0]:z=0;break;default:z=!1}switch(z){case 1:l=w.find("title").text();break;case 0:l=w.filter("title").text();break;case !1:l=a("<span/>").html(d.find(x,
/<title[^>]*?>([^<]*?)<\/title>/i).shift()).text()}if(!a(h.area).length||!w.find(h.area).add(z?"":w.filter(h.area)).length)throw Error("throw: area length mismatch");a(b).trigger(h.gns+".unload");!1!==d.fire(n.url.before,null,[g,h.parameter,s,t,p],h.callbacks.async)&&(m&&c!==h.location.href&&b.history.pushState(d.fire(h.state,null,[g,c]),b.opera||-1!==b.navigator.userAgent.toLowerCase().indexOf("opera")?l:e.title,c),h.location.href=c,m&&h.fix.location&&(a[d.name].off(),b.history.back(),b.history.forward(),
a[d.name].on()),d.fire(n.url.after,null,[g,h.parameter,s,t,p],h.callbacks.async));!1!==d.fire(n.title.before,null,[g,h.parameter,s,t,p],h.callbacks.async)&&(e.title=l,h.database&&h.fix.history&&d.dbTitle(c,l),d.fire(n.title.after,null,[g,h.parameter,s,t,p],h.callbacks.async));h.database&&d.dbCurrent();var I=function(e){var c,f;switch(g.type.toLowerCase()){case "click":case "submit":c=e&&"function"===typeof h.scrollLeft?d.fire(h.scrollLeft,null,[g]):h.scrollLeft;c=0<=c?c:0;c=null===c?a(b).scrollLeft():
parseInt(Number(c),10);f=e&&"function"===typeof h.scrollTop?d.fire(h.scrollTop,null,[g]):h.scrollTop;f=0<=f?f:0;f=null===f?a(b).scrollTop():parseInt(Number(f),10);a(b).scrollTop()===f&&a(b).scrollLeft()===c||b.scrollTo(c,f);e&&h.database&&h.fix.scroll&&d.dbScroll(c,f);break;case "popstate":e&&h.database&&h.fix.scroll&&d.dbScroll()}};I(!1);if(!1!==d.fire(n.content.before,null,[g,h.parameter,s,t,p],h.callbacks.async)){a(h.area).children("."+h.nss.class4html+"-check").remove();C=a("<div/>",{"class":h.nss.class4html+
"-check",style:"background: none !important; display: block !important; visibility: hidden !important; position: absolute !important; top: 0 !important; left: 0 !important; z-index: -9999 !important; width: auto !important; height: 0 !important; margin: 0 !important; padding: 0 !important; border: none !important; font-size: 12px !important; text-indent: 0 !important;"}).text(h.gns);for(A=0;B=E[A++];)H=w.find(B).add(z?"":w.filter(B)).clone().find("script").remove().end().contents(),a(B).html(H).append(C.clone());
C=a(h.area).children("."+h.nss.class4html+"-check");a(e).trigger(h.gns+".DOMContentLoaded");d.fire(n.content.after,null,[g,h.parameter,s,t,p],h.callbacks.async)}k&&k.XMLHttpRequest||!h.cache.click&&!h.cache.submit&&!h.cache.popstate||"submit"===g.type.toLowerCase()&&!h.cache[g.target.method.toLowerCase()]||!1===d.fire(n.cache.save.before,null,[g,h.parameter,k],h.callbacks.async)||(a[d.name].setCache(c,v||null,t,p),k=a[d.name].getCache(c),d.fire(n.cache.save.after,null,[g,h.parameter,k],h.callbacks.async));
var J=function(b){if(!1!==d.fire(n.rendering.before,null,[g,h.parameter],h.callbacks.async)){var c=0;(function(){C.filter(function(){return this.clientWidth||this.clientHeight||a(this).is(":hidden")}).length===C.length||100<=c?D(b):C.length&&(c++,setTimeout(arguments.callee,h.interval))})()}},D=function(c){C.remove();h.scroll.record=!0;d.hashscroll("popstate"===g.type.toLowerCase())||I(!0);a(b).trigger(h.gns+".load");d.fire(c);d.fire(n.rendering.after,null,[g,h.parameter],h.callbacks.async)};switch(z){case 1:case 0:w.find("noscript").remove();
break;case !1:x=x.replace(/^(?:.|[\n\r])*<body[^>]*>.*[\n\r]*.*[\n\r]*/im,function(a){return a.replace(/\x3c!--\[(?:.|[\n\r])*?<!\[endif\]--\x3e/gim,"")}),x=x.replace(/<noscript(?:.|[\n\r])*?<\/noscript>/gim,"")}var G=function(e){if(h.load.script&&!1!==d.fire(n.script.before,null,[g,h.parameter,s,t,p],h.callbacks.async)){var f;f=(k=a[d.name].getCache(c))&&!k.script;switch(u||z){case 1:case 0:u=w.find("script").add(z?"":w.filter("script")).clone().get();break;case !1:u=d.find(x,/(?:[^\'\"]|^\s*?)(<script[^>]*?>(?:.|[\n\r])*?<\/script>)(?:[^\'\"]|\s*?$)/gim)}k&&
k.script&&u&&u.length!==k.script.length&&(f=!0);f&&(k.script=[]);for(var m=0,l,q;l=u[m];m++)if(l="object"===typeof l?f?a(l.outerHTML)[0]:l:a(l)[0],l="function"===typeof h.load.rewrite?d.fire(h.load.rewrite,null,[l.cloneNode()])||l:l,f&&(k.script[m]=l),a(l).is(e)&&(q=d.trim(l.src||""),!(q&&q in h.log.script||h.load.reject&&a(l).is(h.load.reject)))){!q||h.load.reload&&a(l).is(h.load.reload)||(h.log.script[q]=!0);try{q?a.ajax(a.extend(!0,{},h.ajax,h.load.ajax,{url:l.src,async:!!l.async,global:!1})):
"object"!==typeof l||l.type&&-1===l.type.toLowerCase().indexOf("text/javascript")||b.eval.call(b,(l.text||l.textContent||l.innerHTML||"").replace(/^\s*<!(?:\[CDATA\[|\-\-)/,"/*$0*/"))}catch(r){break}}d.fire(n.script.after,null,[g,h.parameter,s,t,p],h.callbacks.async)}};if(!1!==d.fire(n.verify.before,null,[g,h.parameter],h.callbacks.async)){if(c===d.canonicalizeURL(b.location.href))h.retry=!0;else if(h.retry)h.retry=!1,d.drive(a,b,e,f,d,h,g,b.location.href,!1,h.cache[g.type.toLowerCase()]&&a[d.name].getCache(d.canonicalizeURL(b.location.href)));
else throw Error("throw: location mismatch");d.fire(n.verify.after,null,[g,h.parameter],h.callbacks.async)}(function(){if(h.load.css&&!1!==d.fire(n.css.before,null,[g,h.parameter,s,t,p],h.callbacks.async)){var b,e=[],f=a('link[rel~="stylesheet"], style');b=(k=a[d.name].getCache(c))&&!k.css;switch(q||z){case 1:case 0:q=w.find('link[rel~="stylesheet"], style').add(z?"":w.filter('link[rel~="stylesheet"], style')).clone().get();break;case !1:q=d.find(x,/(<link[^>]*?rel=.[^"\']*?stylesheet[^>]*?>|<style[^>]*?>(?:.|[\n\r])*?<\/style>)/gim)}k&&
k.css&&q&&q.length!==k.css.length&&(b=!0);b&&(k.css=[]);for(var m=0,l,r;l=q[m];m++){l="object"===typeof l?b?a(l.outerHTML)[0]:l:a(l)[0];l="function"===typeof h.load.rewrite?d.fire(h.load.rewrite,null,[l.cloneNode()])||l:l;b&&(k.css[m]=l);r=d.trim(l.href||l.innerHTML||"");for(var u=0,v;v=f[u];u++)if(d.trim(v.href||v.innerHTML||"")===r){f=f.not(v);l=null;break}l&&e.push(l)}f.remove();a("head").append(e);d.fire(n.css.after,null,[g,h.parameter,s,t,p],h.callbacks.async)}})();a(e).trigger(h.gns+".ready");
a(b).bind(h.gns+".rendering",function(b){a(b.target).unbind(b.type+".rendering",arguments.callee);G(":not([defer]), :not([src])");h.load.sync?J(function(){G("[src][defer]")}):(J(),G("[src][defer]"))}).trigger(h.gns+".rendering").unbind(h.gns+".rendering");if(!1===d.fire(n.success,null,[g,h.parameter,s,t,p],h.callbacks.async))break a;if(!1===d.fire(n.complete,null,[g,h.parameter,s,t,p],h.callbacks.async))break a;if(!1===d.fire(h.callback,null,[g,h.parameter,s,t,p],h.callbacks.async))break a}catch(L){k&&
a[d.name].setCache(c);if(!1===d.fire(n.error,null,[g,h.parameter,s,t,p],h.callbacks.async))break a;if(!1===d.fire(n.complete,null,[g,h.parameter,s,t,p],h.callbacks.async))break a;if(h.fallback)return"function"===typeof h.fallback?d.fire(h.fallback,null,[g,c]):d.fallback(g)}d.fire(n.after,null,[g,h.parameter,s,t,p],h.callbacks.async)}}}b.scroll.record=!1;b.fix.reset&&/click|submit/.test(k.type.toLowerCase())&&f.scrollTo(a(f).scrollLeft(),0);if(!1!==e.fire(b.callbacks.before,null,[k,b.parameter],b.callbacks.async))if(n&&
n.XMLHttpRequest)a.when?a.when(e.wait(b.wait)).done(function(){r(a,f,d,g,e,b,k,n)}):r(a,f,d,g,e,b,k,n);else{var q,u,s,p,t,y;q={};switch(k.type.toLowerCase()){case "click":q.type="GET";break;case "submit":q.type=k.target.method.toUpperCase();"POST"===q.type&&(q.data=a(k.target).serializeArray());break;case "popstate":q.type="GET"}u=a.when?a.Deferred():null;a.extend(!0,q,b.ajax,{xhr:b.callbacks.ajax.xhr?function(){p=e.fire(b.callbacks.ajax.xhr,null,[k,b.parameter],b.callbacks.async);return p="object"===
typeof p&&p||a.ajaxSettings.xhr()}:g,beforeSend:function(a,c){p=a;b.xhr&&4>b.xhr.readyState&&b.xhr.abort();b.xhr=p;p.setRequestHeader(b.nss.requestHeader,"true");p.setRequestHeader(b.nss.requestHeader+"-Area",b.area);p.setRequestHeader(b.nss.requestHeader+"-CSS",b.load.css);p.setRequestHeader(b.nss.requestHeader+"-Script",b.load.script);e.fire(b.callbacks.ajax.beforeSend,null,[k,b.parameter,p,c],b.callbacks.async)},dataFilter:b.callbacks.ajax.dataFilter?function(a,c){s=a;return e.fire(b.callbacks.ajax.dataFilter,
null,[k,b.parameter,s,c],b.callbacks.async)||s}:g,success:function(a,c,d){s=a;t=c;p=d;e.fire(b.callbacks.ajax.success,null,[k,b.parameter,s,t,p],b.callbacks.async)},error:function(a,c,d){p=a;t=c;y=d;e.fire(b.callbacks.ajax.error,null,[k,b.parameter,p,t,y],b.callbacks.async)},complete:function(m,q){p=m;t=q;e.fire(b.callbacks.ajax.complete,null,[k,b.parameter,p,t],b.callbacks.async);if(y){if(u&&u.reject(),b.fallback&&"abort"!==t)return"function"===typeof b.fallback?e.fire(b.fallback,null,[k,c]):e.fallback(k)}else u&&
u.resolve()||r(a,f,d,g,e,b,k,n)}});q.url=c.replace(/([^#]+)(#[^\s]*)?$/,"$1"+(b.server.query?(c.match(/\?/)?"&":"?")+encodeURIComponent(b.server.query)+"=1":"")+"$2");a.when&&a.when(u.promise(),e.wait(b.wait)).done(function(){r(a,f,d,g,e,b,k,n)});a.ajax(q);e.fire(b.callbacks.after,null,[k,b.parameter],b.callbacks.async)}},canonicalizeURL:function(a){a=g.trim(a);a=/^https?:/i.test(a)?a:"";a=a.replace(/[<>"{}|\\^\[\]`\s].*/,"");return encodeURI(decodeURI(a))},trim:function(a){if(String.prototype.trim)a=
String(a).trim();else if(a=String(a).replace(/^\s+/,""))for(var f=a.length;--f;)if(/\S/.test(a.charAt(f))){a=a.substring(0,f+1);break}return a},fire:function(a,f,d,g){return"function"===typeof a?g?setTimeout(function(){a.apply(f,d)},0):a.apply(f,d):a},hashscroll:function(a){var f=g.settings[1].destination.hash.slice(1);return!(a||!f)&&n("#"+(f?f:", [name~="+f+"]")).first().each(function(){isFinite(n(this).offset().top)&&r.scrollTo(n(r).scrollLeft(),parseInt(Number(n(this).offset().top),10))}).length},
wait:function(a){var f=n.Deferred();if(!a)return f.resolve();setTimeout(function(){f.resolve()},a);return f.promise()},fallback:function(a){switch(a.type.toLowerCase()){case "click":r.location.href=a.currentTarget.href;break;case "submit":a.target.submit();break;case "popstate":r.location.reload()}},find:function(a,f){var d=[];a.replace(f,function(a,e){d.push(e)});return d},scope:function(a,f){var d,l,e,b,k,c,m,r,A,q,u,s,p,t;d=a.scope;e=a.location.pathname+a.location.search+a.location.hash;b=a.destination.pathname+
a.destination.search+a.destination.hash;"/"!==a.location.pathname.charAt(0)&&(e="/"+e,b="/"+b);l=e.replace(/^\//,"").replace(/([?#])/g,"/$1").split("/");c=(f||e).replace(/^\//,"").replace(/([?#])/g,"/$1").split("/");if(f){if(-1===f.indexOf("*"))return v;k=[];for(var y=c.length;y--;)"*"===c[y]&&k.unshift(l[y])}for(y=c.length+1;y--;)if(q=u=s=p=v,l=c.slice(0,y).join("/").replace(/\/([?#])/g,"$1"),(l="/"+l+("/"===(f||e).charAt(l.length+1)?"/":""))&&l in d){if(!d[l]||!d[l].length)return!1;for(var D=0;m=
d[l][D];D++)if(!1!==s&&!1!==p)if("rewrite"!==m||"function"!==typeof d.rewrite||f)if("inherit"===m)u=!0;else if("string"===typeof m){m=(r="^"===m.charAt(0))?m.slice(1):m;m=(A="*"===m.charAt(0))?m.slice(1):m;if(f&&-1!==m.indexOf("/*/"))for(var F=0,K=k.length;F<K;F++)m=m.replace("/*/","/"+k[F]+"/");if(!(!r&&s||(A?e.search(m):e.indexOf(m)))){if(r)return!1;s=!0}if(!(!r&&p||(A?b.search(m):b.indexOf(m)))){if(r)return!1;p=!0}}else"object"===typeof m&&(t=m);else if(q=arguments.callee(a,g.fire(d.rewrite,null,
[a.destination.href])))s=p=!0;else if(!1===q)return!1;if(s&&p)return a.option||q?n.extend(!0,{},q||{}):n.extend(!0,{},a,t||{},q||{});if(!u)break}},database:function(){var a=g.settings[1],f=1,d=a.database,l=a.gns,e,b,k=Math.floor(a.timestamp/864E5);if(!d||!l||!d.open)return!1;try{f=parseInt(k-k%7+f,10),e=d.open(l),e.onblocked=function(){a.database=!1},e.onupgradeneeded=function(){for(var b=a.database=this.result,c=b.objectStoreNames?b.objectStoreNames.length:0;c--;)b.deleteObjectStore(b.objectStoreNames[c]);
a.database.createObjectStore(a.gns,{keyPath:"id",autoIncrement:!1}).createIndex("date","date",{unique:!1})},e.onsuccess=function(){try{a.database=this.result,b=g.dbStore(),b.get("_version").onsuccess=function(){this.result&&f!==this.result.title?(a.database.close(),d.deleteDatabase(l),a.database=d,g.database()):(g.dbVersion(f),g.dbCurrent(),g.dbTitle(a.location.href,A.title))}}catch(c){a.database.close(),d.deleteDatabase(l),a.database=!1}},e.onerror=function(b){a.database=!1;d.deleteDatabase(l)}}catch(c){a.database=
!1}},dbStore:function(){var a=g.settings[1];return"object"===typeof a.database&&"function"===typeof a.database.transaction&&a.database.transaction(a.gns,"readwrite").objectStore(a.gns)},dbCurrent:function(){var a=g.settings[1],f=g.dbStore();f&&f.put({id:"_current",title:a.hashquery?r.location.href:r.location.href.replace(/#.*/,"")})},dbVersion:function(a){var f=g.dbStore();f&&f.put({id:"_version",title:a})},dbTitle:function(a,f){var d=g.settings[1],l=g.dbStore();l&&(d.hashquery||(a=a.replace(/#.*/,
"")),f?l.get(a).onsuccess=function(){l.put(n.extend(!0,{},this.result||{},{id:a,title:f,date:d.timestamp}));g.dbClean(l)}:l.get(a).onsuccess=function(){this.result&&this.result.title&&(A.title=this.result.title)})},dbScroll:function(a,f){var d=g.settings[1],l=g.dbStore(),e=d.location.href,b=arguments.length;d.scroll.record&&l&&(d.hashquery||(e=e.replace(/#.*/,"")),l.get("_current").onsuccess=function(){this.result&&this.result.title&&e===this.result.title&&(b?l.get(e).onsuccess=function(){l.put(n.extend(!0,
{},this.result||{},{scrollX:parseInt(Number(a),10),scrollY:parseInt(Number(f),10)}))}:l.get(e).onsuccess=function(){this.result&&isFinite(this.result.scrollX)&&isFinite(this.result.scrollY)&&r.scrollTo(parseInt(Number(this.result.scrollX),10),parseInt(Number(this.result.scrollY),10))})})},dbClean:function(a){var f=g.settings[1],d=r.IDBKeyRange||r.webkitIDBKeyRange||r.mozIDBKeyRange||r.msIDBKeyRange;a.count().onsuccess=function(){1E3<this.result&&(a.index("date").openCursor(d.upperBound(f.timestamp-
2592E5)).onsuccess=function(){var d=this.result;d?(d["delete"](d.value.id),d["continue"]()):a.count().onsuccess=function(){1E3<this.result&&a.clear()}})}},share:function(){var a=g.settings[1];n.falsandtru||(n.fn.falsandtru=n.falsandtru=g.falsandtru);n.falsandtru("share","history",a.history);a.history=n.falsandtru("share","history")},falsandtru:function(a,f,d){var g;switch(!0){case f===v:g=n.falsandtru[a];break;case d===v:g=a in n.falsandtru?n.falsandtru[a][f]:v;break;case d!==v:n.falsandtru[a]instanceof
Object||(n.falsandtru[a]={}),n.falsandtru[a][f]instanceof Object&&d instanceof Object?n.extend(!0,n.falsandtru[a][f],d):n.falsandtru[a][f]=d,g=n.falsandtru[a][f]}return g}};(function(a,f,d,g,e){a.fn[e.name]=a[e.name]=function(){return D.apply(this,[a,f,d,g,e].concat([].slice.call(arguments)))};e.setProperties.call(a[e.name])}).apply(this,[].slice.call(arguments).concat([g]))})(jQuery,window,document,void 0);
