/*
 * 
 * pjax
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT http://opensource.org/licenses/mit-license.php
 * @version 1.30.1
 * @updated 2014/01/16
 * @author falsandtru https://github.com/falsandtru/
 * @Compressor Closure Compiler
 */
(function(g,m,z,A){function D(a,e,k,l,c,b){var q=this;switch(!0){case "object"===typeof b:q=q instanceof a?q:a(k);q=c.setProperties.call(q,b.ns||"",null);if(!b.area)return q;break;default:return q=q instanceof a?q:a[c.name],c.setProperties.call(q,null,null)}var d;d=a.extend(!0,{id:0,gns:c.name,ns:null,area:null,link:"a:not([target])",form:null,scope:null,state:null,scrollTop:0,scrollLeft:0,ajax:{},contentType:"text/html",cache:{click:!1,submit:!1,popstate:!1,get:!0,post:!0,length:9,size:1048576,expire:18E5},
callback:function(){},callbacks:{ajax:{},update:{url:{},title:{},content:{},css:{},script:{},cache:{load:{},save:{}},rendering:{},verify:{}},async:!1},parameter:null,load:{css:!1,script:!1,execute:!0,reload:null,reject:null,sync:!0,ajax:{dataType:"script"},rewrite:null},interval:300,wait:0,scroll:{delay:500},fix:{location:!0,history:!0,scroll:!0,reset:!1},hashquery:!1,fallback:!0,database:!0,server:{},location:a("<a/>",{href:c.canonicalizeURL(e.location.href)})[0],destination:a("<a/>",{href:c.canonicalizeURL(e.location.href)})[0],
speedcheck:!1},b);d.nss={array:[c.name].concat(d.ns&&String(d.ns).split(".")||[])};a.extend(!0,d=d.scope&&c.scope(d)||d,{nss:{name:d.ns||"",event:d.nss.array.join("."),alias:c.alias?[c.alias].concat(d.nss.array.slice(1)).join("."):!1,click:["click"].concat(d.nss.array.join(":")).join("."),submit:["submit"].concat(d.nss.array.join(":")).join("."),popstate:["popstate"].concat(d.nss.array.join(":")).join("."),scroll:["scroll"].concat(d.nss.array.join(":")).join("."),data:d.nss.array.join("-"),class4html:d.nss.array.join("-"),
requestHeader:["X",d.nss.array[0].replace(/^\w/,function(c){return c.toUpperCase()})].join("-")},areaback:d.area,fix:/Mobile(\/\w+)? Safari/i.test(e.navigator.userAgent)?{}:{location:!1,reset:!1},contentType:d.contentType.replace(/\s*[,;]\s*/g,"|").toLowerCase(),scroll:{record:!0,queue:[]},database:d.database?e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.msIndexedDB||null:!1,server:{query:d.server.query?d.server.query:d.gns},log:{script:{},speed:{}},history:{config:d.cache,order:[],data:{},size:0},
timestamp:(new Date).getTime(),disable:!1,landing:c.canonicalizeURL(e.location.href),retry:!0,xhr:null,speed:{now:function(){return(new Date).getTime()}},option:b,validator:validator});c.check()&&c.registrate.call(q,a,e,k,l,c,d);return q}var f;f={name:"pjax",alias:"",ids:[0],settings:[0],count:0,parseHTML:null,setAlias:function(a){f.alias="string"===typeof a?a:f.alias;f.name===f.alias||g[f.alias]||(g[f.name][f.alias]=g.fn[f.name],g.fn[f.alias]=g[f.alias]=g.fn[f.name])},setProperties:function(a,e){var k=
this;if(k instanceof g||k===g[f.name])k=k instanceof g&&e!==A?k.add(e):k,k[f.name]=g[f.name],k.on=function(){f.settings[1].disable=!1},k.off=function(){f.settings[1].disable=!0},k.click=function(a,c){c=c||{};return(c.href=a)?g("<a/>",c).one("click",1,f.click).click():!1},k.submit=function(a,c,b){var q=z.createDocumentFragment(),d;switch(!0){case "object"===typeof a:c=g(a);break;case !!b:c=c||{};c.action=a;a=b instanceof Array&&Array||b instanceof Object&&Object||A;for(var e in b){d=b[e];switch(a){case Object:d=
g("<textarea/>",{name:e}).val(d);break;case Array:d.attr=d.attr||{};d.attr.name=d.name;d=g(d.tag.indexOf("<")?"<"+d.tag+"/>":d.tag,d.attr||{}).val(d.value);break;default:continue}q.appendChild(d[0])}c=g("<form/>",c).append(q);break;default:return!1}c.one("submit",1,f.submit).submit();return!0},k.setCache=function(a,c,b,q){var d=f.settings[1];if(!d||!d.history)return!1;var e,k,s;e=d.history;a=a||f.canonicalizeURL(m.location.href);d.hashquery||(a=a.replace(/#.*/,""));switch(arguments.length){case 0:case 1:return arguments.callee.call(this,
a,f.trim(z.documentElement.outerHTML));default:e.order.unshift(a);for(k=1;s=e.order[k];k++)a===s&&e.order.splice(k,1);e.size>e.config.size&&g[f.name].cleanCache();g[f.name].getCache(a);k=g("<span/>").html(f.find((c||"")+((q||{}).responseText||"")+"<title></title>",/<title[^>]*?>([^<]*?)<\/title>/i).shift()).text();s=parseInt(1.8*((c||"").length+((q||{}).responseText||"").length)||1048576,10);e.size=e.size||0;e.size+=s;e.data[a]=g.extend(!0,e.data[a]||{},{XMLHttpRequest:q,textStatus:b,data:c,size:s,
timestamp:(new Date).getTime()});d.database&&d.fix.history&&f.dbTitle(a,k)}return e.data[a]},k.getCache=function(a){var c=f.settings[1];if(!c||!c.history)return!1;var b;b=c.history;a=a||f.canonicalizeURL(m.location.href);c.hashquery||(a=a.replace(/#.*/,""));b.data[a]&&c.timestamp>b.data[a].timestamp+b.config.expire&&g[f.name].removeCache(a);return b.data[a]},k.removeCache=function(a){var c=f.settings[1];if(!c||!c.history)return!1;var b;b=c.history;a=a||f.canonicalizeURL(m.location.href);c.hashquery||
(a=a.replace(/#.*/,""));for(var c=0,e;e=b.order[c];c++)a===e&&(b.order.splice(c,1),b.size-=b.data[e].size,b.data[e]=null,delete b.data[e]);return!0},k.clearCache=function(){var a=f.settings[1];if(!a||!a.history)return!1;for(var a=a.history,c=a.order.length,b;b=a.order[--c];)a.order.splice(c,1),a.size-=a.data[b].size,delete a.data[b];return!0},k.cleanCache=function(){var a=f.settings[1];if(!a||!a.history)return!1;for(var c=a.history,b=c.order.length,e;e=c.order[--b];)if(b>=c.config.length||e in c.data&&
a.timestamp>c.data[e].timestamp+c.config.expire)c.order.splice(b,1),c.size-=c.data[e].size,delete c.data[e];return!0};return k},check:function(){return f.supportPushState()},supportPushState:function(){return"pushState"in m.history&&m.history.pushState},registrate:function(a,e,k,l,c,b){b.id=1;c.ids.push(b.id);c.settings[b.id]=b;c.share();c.database();b.load.script&&a("script").each(function(){var e=this,d,e="function"===typeof b.load.rewrite?c.fire(b.load.rewrite,null,[e.cloneNode()])||e:e;(d=e.src)&&
d in b.log.script||!d||b.load.reload&&a(e).is(b.load.reload)||(b.log.script[d]=!0)});a(this).undelegate(b.link,b.nss.click).delegate(b.link,b.nss.click,b.id,c.click=function(b){b.timeStamp=(new Date).getTime();var d=c.settings[1];if(d.disable||b.isDefaultPrevented())return b.preventDefault();d.location.href=c.canonicalizeURL(e.location.href);d.destination.href=c.canonicalizeURL(this.href);if(d.location.protocol===d.destination.protocol&&d.location.host===d.destination.host&&!(1<b.which||b.metaKey||
b.ctrlKey||b.shiftKey||b.altKey)){if(!c.fire(d.hashquery,null,[b,this.href])&&d.location.pathname+d.location.search===d.destination.pathname+d.destination.search)return d.destination.hash&&c.hashscroll(),b.preventDefault();var f,g;f=d.destination.href;d.area=c.fire(d.areaback,null,[b,f]);d.timestamp=b.timeStamp;d.landing&&(d.landing=!1);if(a(d.area).length&&(!d.scope||c.scope(d)))return d.cache[b.type.toLowerCase()]&&(g=a[c.name].getCache(f)),c.drive(a,e,k,l,c,d,b,f,!0,g),b.preventDefault()}});a(this).undelegate(b.form,
b.nss.submit).delegate(b.form,b.nss.submit,b.id,c.submit=function(b){b.timeStamp=(new Date).getTime();var d=c.settings[1];if(d.disable||b.isDefaultPrevented())return b.preventDefault();d.location.href=c.canonicalizeURL(e.location.href);d.destination.href=c.canonicalizeURL(this.action);if(!(1<b.which||b.metaKey||b.ctrlKey||b.shiftKey||b.altKey)){var f,g;f=d.destination.href=c.canonicalizeURL(d.destination.href.replace(/[?#].*/,"")+("GET"===b.target.method.toUpperCase()?"?"+a(b.target).serialize():
""));d.area=c.fire(d.areaback,null,[b,f]);d.timestamp=b.timeStamp;d.landing&&(d.landing=!1);if(a(d.area).length&&(!d.scope||c.scope(d)))return d.cache[b.type.toLowerCase()]&&d.cache[b.target.method.toLowerCase()]&&(g=a[c.name].getCache(f)),c.drive(a,e,k,l,c,d,b,f,!0,g),b.preventDefault()}});a(e).unbind(b.nss.popstate).bind(b.nss.popstate,b.id,c.popstate=function(b){b.timeStamp=(new Date).getTime();var d=c.settings[1];if(d.disable||b.isDefaultPrevented())return b.preventDefault();d.destination.href=
c.canonicalizeURL(e.location.href);if(d.location.href===d.destination.href)return b.preventDefault();var f,g;if(!c.fire(d.hashquery,null,[b,f])&&d.location.pathname+d.location.search===d.destination.pathname+d.destination.search)return b.preventDefault();f=d.destination.href;d.area=c.fire(d.areaback,null,[b,f]);d.timestamp=b.timeStamp;if(d.landing){if(d.landing.href===f){d.landing=!1;return}d.landing=!1}if(a(d.area).length)return d.database&&d.fix.history&&c.dbTitle(f),d.cache[b.type.toLowerCase()]&&
(g=a[c.name].getCache(f)),c.drive(a,e,k,l,c,d,b,f,!1,g),b.preventDefault()});b.database&&b.fix.scroll&&a(e).unbind(b.nss.scroll).bind(b.nss.scroll,b.id,function(b,d){var k=c.settings[1],f;if(k.scroll.delay){for(;f=k.scroll.queue.shift();)clearTimeout(f);f=setTimeout(function(){for(;f=k.scroll.queue.shift();)clearTimeout(f);c.dbScroll(a(e).scrollLeft(),a(e).scrollTop())},k.scroll.delay);k.scroll.queue.push(f)}else c.dbScroll(a(e).scrollLeft(),a(e).scrollTop())});(function(){function b(c){try{var d=
c&&c("<body><noscript>DOMParser</noscript></body>");return"DOMParser"===a(d).find("noscript").text()}catch(e){}}var d=e.DOMParser;c.parseHTML=function(a){return d&&d.prototype&&(new d).parseFromString(a,"text/html")};b(c.parseHTML)||(c.parseHTML=function(a){var b;k.implementation&&k.implementation.createHTMLDocument&&(b=k.implementation.createHTMLDocument(""),"object"===typeof b.activeElement&&(b.open(),b.write(a),b.close()));return b},b(c.parseHTML)||(c.parseHTML=!1))})()},drive:function(a,e,f,l,
c,b,g,d,n,v){function s(a,b,c,e,f,h,k,g){a:{var l=h.callbacks.update;if(!1!==f.fire(l.before,null,[k,h.parameter,r,t,p,g],h.callbacks.async)){var q,m,v;try{if(!g&&-1===(p.getResponseHeader("Content-Type")||"").toLowerCase().search(h.contentType))throw Error("throw: content-type mismatch");g&&!1!==f.fire(l.cache.load.before,null,[k,h.parameter,g],h.callbacks.async)&&(p=g.XMLHttpRequest||p,r=p.responseText,t=g.textStatus||t,m=g.css,v=g.script,f.fire(l.cache.load.after,null,[k,h.parameter,g],h.callbacks.async));
var x,s,u,w,y,A,C;A=h.area.split(/\s*,\s*/);s=(p.responseText||"").replace(/<noscript[^>]*>(?:.|[\n\r])*?<\/noscript>/gim,function(a){return a.replace(/<script(?:.|[\n\r])*?<\/script>/gim,"")});if(g&&g.data){w=g.data;u=a(f.parseHTML&&w&&f.parseHTML(w)||w);s=s.replace(/<title[^>]*?>([^<]*?)<\/title>/i,function(a){return f.find(w,/(<title[^>]*?>[^<]*?<\/title>)/i).shift()||a});x=a(f.parseHTML&&s&&f.parseHTML(s)||s);for(var z=0,B,I;B=A[z++];)x.find(B).add(y?"":x.filter(B)).html(u.find(B).add(y?"":u.filter(B)).contents())}else x=
a(f.parseHTML&&s&&f.parseHTML(s)||s);switch(!0){case !!x.find("html")[0]:y=1;x.find("noscript").each(function(){this.children.length&&a(this).text(this.innerHTML)});break;case !!x.filter("title")[0]:y=0;break;default:y=!1}switch(y){case 1:q=x.find("title").text();break;case 0:q=x.filter("title").text();break;case !1:q=a("<span/>").html(f.find(s,/<title[^>]*?>([^<]*?)<\/title>/i).shift()).text()}if(!a(h.area).length||!x.find(h.area).add(y?"":x.filter(h.area)).length)throw Error("throw: area length mismatch");
a(b).trigger(h.gns+".unload");!1!==f.fire(l.url.before,null,[k,h.parameter,r,t,p],h.callbacks.async)&&(n&&d!==h.location.href&&b.history.pushState(f.fire(h.state,null,[k,d]),b.opera||-1!==b.navigator.userAgent.toLowerCase().indexOf("opera")?q:c.title,d),h.location.href=d,n&&h.fix.location&&(a[f.name].off(),b.history.back(),b.history.forward(),a[f.name].on()),f.fire(l.url.after,null,[k,h.parameter,r,t,p],h.callbacks.async));!1!==f.fire(l.title.before,null,[k,h.parameter,r,t,p],h.callbacks.async)&&
(c.title=q,h.database&&h.fix.history&&f.dbTitle(d,q),f.fire(l.title.after,null,[k,h.parameter,r,t,p],h.callbacks.async));h.database&&f.dbCurrent();var G=function(c){var d,e;switch(k.type.toLowerCase()){case "click":case "submit":d=c&&"function"===typeof h.scrollLeft?f.fire(h.scrollLeft,null,[k]):h.scrollLeft;d=0<=d?d:0;d=null===d?a(b).scrollLeft():parseInt(Number(d),10);e=c&&"function"===typeof h.scrollTop?f.fire(h.scrollTop,null,[k]):h.scrollTop;e=0<=e?e:0;e=null===e?a(b).scrollTop():parseInt(Number(e),
10);a(b).scrollTop()===e&&a(b).scrollLeft()===d||b.scrollTo(d,e);c&&h.database&&h.fix.scroll&&f.dbScroll(d,e);break;case "popstate":c&&h.database&&h.fix.scroll&&f.dbScroll()}};G(!1);if(!1!==f.fire(l.content.before,null,[k,h.parameter,r,t,p],h.callbacks.async)){a(h.area).children("."+h.nss.class4html+"-check").remove();C=a("<div/>",{"class":h.nss.class4html+"-check",style:"background: none !important; display: block !important; visibility: hidden !important; position: absolute !important; top: 0 !important; left: 0 !important; z-index: -9999 !important; width: auto !important; height: 0 !important; margin: 0 !important; padding: 0 !important; border: none !important; font-size: 12px !important; text-indent: 0 !important;"}).text(h.gns);
for(z=0;B=A[z++];)I=x.find(B).add(y?"":x.filter(B)).clone().find("script").remove().end().contents(),a(B).html(I).append(C.clone());C=a(h.area).children("."+h.nss.class4html+"-check");a(c).trigger(h.gns+".DOMContentLoaded");f.fire(l.content.after,null,[k,h.parameter,r,t,p],h.callbacks.async)}g&&g.XMLHttpRequest||!h.cache.click&&!h.cache.submit&&!h.cache.popstate||"submit"===k.type.toLowerCase()&&!h.cache[k.target.method.toLowerCase()]||!1===f.fire(l.cache.save.before,null,[k,h.parameter,g],h.callbacks.async)||
(a[f.name].setCache(d,w||null,t,p),g=a[f.name].getCache(d),f.fire(l.cache.save.after,null,[k,h.parameter,g],h.callbacks.async));var H=function(b){if(!1!==f.fire(l.rendering.before,null,[k,h.parameter],h.callbacks.async)){var c=0;(function(){C.filter(function(){return this.clientWidth||this.clientHeight||a(this).is(":hidden")}).length===C.length||100<=c?D(b):C.length&&(c++,setTimeout(arguments.callee,h.interval))})()}},D=function(c){C.remove();h.scroll.record=!0;f.hashscroll("popstate"===k.type.toLowerCase())||
G(!0);a(b).trigger(h.gns+".load");f.fire(c);f.fire(l.rendering.after,null,[k,h.parameter],h.callbacks.async)};switch(y){case 1:case 0:x.find("noscript").remove();break;case !1:s=s.replace(/^(?:.|[\n\r])*<body[^>]*>.*[\n\r]*.*[\n\r]*/im,function(a){return a.replace(/\x3c!--\[(?:.|[\n\r])*?<!\[endif\]--\x3e/gim,"")}),s=s.replace(/<noscript(?:.|[\n\r])*?<\/noscript>/gim,"")}var F=function(c){if(h.load.script&&!1!==f.fire(l.script.before,null,[k,h.parameter,r,t,p],h.callbacks.async)){var e;e=(g=a[f.name].getCache(d))&&
!g.script;switch(v||y){case 1:case 0:v=x.find("script").add(y?"":x.filter("script")).clone().get();break;case !1:v=f.find(s,/(?:[^\'\"]|^\s*?)(<script[^>]*?>(?:.|[\n\r])*?<\/script>)(?:[^\'\"]|\s*?$)/gim)}g&&g.script&&v&&v.length!==g.script.length&&(e=!0);e&&(g.script=[]);for(var q=0,m,n;m=v[q];q++)if(m="object"===typeof m?e?a(m.outerHTML)[0]:m:a(m)[0],m="function"===typeof h.load.rewrite?f.fire(h.load.rewrite,null,[m.cloneNode()])||m:m,e&&(g.script[q]=m),a(m).is(c)&&(n=f.trim(m.src||""),!(n&&n in
h.log.script||h.load.reject&&a(m).is(h.load.reject)))){!n||h.load.reload&&a(m).is(h.load.reload)||(h.log.script[n]=!0);try{n?a.ajax(a.extend(!0,{},h.ajax,h.load.ajax,{url:m.src,async:!!m.async,global:!1})):"object"!==typeof m||m.type&&-1===m.type.toLowerCase().indexOf("text/javascript")||b.eval.call(b,(m.text||m.textContent||m.innerHTML||"").replace(/^\s*<!(?:\[CDATA\[|\-\-)/,"/*$0*/"))}catch(u){break}}f.fire(l.script.after,null,[k,h.parameter,r,t,p],h.callbacks.async)}};if(!1!==f.fire(l.verify.before,
null,[k,h.parameter],h.callbacks.async)){if(d===f.canonicalizeURL(b.location.href))h.retry=!0;else if(h.retry)h.retry=!1,f.drive(a,b,c,e,f,h,k,b.location.href,!1,h.cache[k.type.toLowerCase()]&&a[f.name].getCache(f.canonicalizeURL(b.location.href)));else throw Error("throw: location mismatch");f.fire(l.verify.after,null,[k,h.parameter],h.callbacks.async)}(function(){if(h.load.css&&!1!==f.fire(l.css.before,null,[k,h.parameter,r,t,p],h.callbacks.async)){var b,c=[],e=a('link[rel~="stylesheet"], style');
b=(g=a[f.name].getCache(d))&&!g.css;switch(m||y){case 1:case 0:m=x.find('link[rel~="stylesheet"], style').add(y?"":x.filter('link[rel~="stylesheet"], style')).clone().get();break;case !1:m=f.find(s,/(<link[^>]*?rel=.[^"\']*?stylesheet[^>]*?>|<style[^>]*?>(?:.|[\n\r])*?<\/style>)/gim)}g&&g.css&&m&&m.length!==g.css.length&&(b=!0);b&&(g.css=[]);for(var q=0,n,v;n=m[q];q++){n="object"===typeof n?b?a(n.outerHTML)[0]:n:a(n)[0];n="function"===typeof h.load.rewrite?f.fire(h.load.rewrite,null,[n.cloneNode()])||
n:n;b&&(g.css[q]=n);v=f.trim(n.href||n.innerHTML||"");for(var u=0,w;w=e[u];u++)if(f.trim(w.href||w.innerHTML||"")===v){e=e.not(w);n=null;break}n&&c.push(n)}e.remove();a("head").append(c);f.fire(l.css.after,null,[k,h.parameter,r,t,p],h.callbacks.async)}})();a(c).trigger(h.gns+".ready");a(b).bind(h.gns+".rendering",function(b){a(b.target).unbind(b.type+".rendering",arguments.callee);F(":not([defer]), :not([src])");h.load.sync?H(function(){F("[src][defer]")}):(H(),F("[src][defer]"))}).trigger(h.gns+
".rendering");if(!1===f.fire(l.success,null,[k,h.parameter,r,t,p],h.callbacks.async))break a;if(!1===f.fire(l.complete,null,[k,h.parameter,r,t,p],h.callbacks.async))break a;if(!1===f.fire(h.callback,null,[k,h.parameter,r,t,p],h.callbacks.async))break a}catch(K){g&&a[f.name].removeCache(d);if(!1===f.fire(l.error,null,[k,h.parameter,r,t,p],h.callbacks.async))break a;if(!1===f.fire(l.complete,null,[k,h.parameter,r,t,p],h.callbacks.async))break a;if(h.fallback)return"function"===typeof h.fallback?f.fire(h.fallback,
null,[k,d]):f.fallback(k)}f.fire(l.after,null,[k,h.parameter,r,t,p],h.callbacks.async)}}}b.scroll.record=!1;b.fix.reset&&/click|submit/.test(g.type.toLowerCase())&&e.scrollTo(a(e).scrollLeft(),0);if(!1!==c.fire(b.callbacks.before,null,[g,b.parameter],b.callbacks.async))if(v&&v.XMLHttpRequest)a.when?a.when(c.wait(b.wait)).done(function(){s(a,e,f,l,c,b,g,v)}):s(a,e,f,l,c,b,g,v);else{var u,m,r,p,t,w;u={};switch(g.type.toLowerCase()){case "click":u.type="GET";break;case "submit":u.type=g.target.method.toUpperCase();
"POST"===u.type&&(u.data=a(g.target).serializeArray());break;case "popstate":u.type="GET"}m=a.when?a.Deferred():null;a.extend(!0,u,b.ajax,{xhr:b.callbacks.ajax.xhr?function(){p=c.fire(b.callbacks.ajax.xhr,null,[g,b.parameter],b.callbacks.async);return p="object"===typeof p&&p||a.ajaxSettings.xhr()}:l,beforeSend:function(a,d){p=a;b.xhr&&4>b.xhr.readyState&&b.xhr.abort();b.xhr=p;p.setRequestHeader(b.nss.requestHeader,"true");p.setRequestHeader(b.nss.requestHeader+"-Area",b.area);p.setRequestHeader(b.nss.requestHeader+
"-CSS",b.load.css);p.setRequestHeader(b.nss.requestHeader+"-Script",b.load.script);c.fire(b.callbacks.ajax.beforeSend,null,[g,b.parameter,p,d],b.callbacks.async)},dataFilter:b.callbacks.ajax.dataFilter?function(a,d){r=a;return c.fire(b.callbacks.ajax.dataFilter,null,[g,b.parameter,r,d],b.callbacks.async)||r}:l,success:function(a,d,e){r=a;t=d;p=e;c.fire(b.callbacks.ajax.success,null,[g,b.parameter,r,t,p],b.callbacks.async)},error:function(a,d,e){p=a;t=d;w=e;c.fire(b.callbacks.ajax.error,null,[g,b.parameter,
p,t,w],b.callbacks.async)},complete:function(n,r){p=n;t=r;c.fire(b.callbacks.ajax.complete,null,[g,b.parameter,p,t],b.callbacks.async);if(w){if(m&&m.reject(),b.fallback&&"abort"!==t)return"function"===typeof b.fallback?c.fire(b.fallback,null,[g,d]):c.fallback(g)}else m&&m.resolve()||s(a,e,f,l,c,b,g,v)}});u.url=d.replace(/([^#]+)(#[^\s]*)?$/,"$1"+(b.server.query?(d.match(/\?/)?"&":"?")+encodeURIComponent(b.server.query)+"=1":"")+"$2");a.when&&a.when(m.promise(),c.wait(b.wait)).done(function(){s(a,
e,f,l,c,b,g,v)});a.ajax(u);c.fire(b.callbacks.after,null,[g,b.parameter],b.callbacks.async)}},canonicalizeURL:function(a){a=f.trim(a);a=/^https?:/i.test(a)?a:"";a=a.replace(/[<>"{}|\\^\[\]`\s].*/,"");return encodeURI(decodeURI(a))},trim:function(a){if(String.prototype.trim)a=String(a).trim();else if(a=String(a).replace(/^\s+/,""))for(var e=a.length;--e;)if(/\S/.test(a.charAt(e))){a=a.substring(0,e+1);break}return a},fire:function(a,e,f,g){return"function"===typeof a?g?setTimeout(function(){a.apply(e,
f)},0):a.apply(e,f):a},hashscroll:function(a){var e=f.settings[1].destination.hash.slice(1);return!(a||!e)&&g("#"+(e?e:", [name~="+e+"]")).first().each(function(){isFinite(g(this).offset().top)&&m.scrollTo(g(m).scrollLeft(),parseInt(Number(g(this).offset().top),10))}).length},wait:function(a){var e=g.Deferred();if(!a)return e.resolve();setTimeout(function(){e.resolve()},a);return e.promise()},fallback:function(a){switch(a.type.toLowerCase()){case "click":m.location.href=a.currentTarget.href;break;
case "submit":a.target.submit();break;case "popstate":m.location.reload()}},find:function(a,e){var f=[];a.replace(e,function(a,c){f.push(c)});return f},scope:function(a,e){var k,l,c,b,m,d,n,v,s,u,z,r,p,t;k=a.scope;c=a.location.pathname+a.location.search+a.location.hash;b=a.destination.pathname+a.destination.search+a.destination.hash;"/"!==a.location.pathname.charAt(0)&&(c="/"+c,b="/"+b);l=c.replace(/^\//,"").replace(/([?#])/g,"/$1").split("/");d=(e||c).replace(/^\//,"").replace(/([?#])/g,"/$1").split("/");
if(e){if(-1===e.indexOf("*"))return A;m=[];for(var w=d.length;w--;)"*"===d[w]&&m.unshift(l[w])}for(w=d.length+1;w--;)if(u=z=r=p=A,l=d.slice(0,w).join("/").replace(/\/([?#])/g,"$1"),(l="/"+l+("/"===(e||c).charAt(l.length+1)?"/":""))&&l in k){if(!k[l]||!k[l].length)return!1;for(var D=0;n=k[l][D];D++)if(!1!==r&&!1!==p)if("rewrite"!==n||"function"!==typeof k.rewrite||e)if("inherit"===n)z=!0;else if("string"===typeof n){n=(v="^"===n.charAt(0))?n.slice(1):n;n=(s="*"===n.charAt(0))?n.slice(1):n;if(e&&-1!==
n.indexOf("/*/"))for(var E=0,J=m.length;E<J;E++)n=n.replace("/*/","/"+m[E]+"/");if(!(!v&&r||(s?c.search(n):c.indexOf(n)))){if(v)return!1;r=!0}if(!(!v&&p||(s?b.search(n):b.indexOf(n)))){if(v)return!1;p=!0}}else"object"===typeof n&&(t=n);else if(u=arguments.callee(a,f.fire(k.rewrite,null,[a.destination.href])))r=p=!0;else if(!1===u)return!1;if(r&&p)return a.option||u?g.extend(!0,{},u||{}):g.extend(!0,{},a,t||{},u||{});if(!z)break}},database:function(a){var e=f.settings[1],g=1,l=e.database,c=e.gns,b,
m,d=Math.floor(e.timestamp/864E5);a=a||0;if(!l||!c||!l.open||3<a)return e.database=!1;try{g=parseInt(d-d%7+g,10),b=l.open(c),b.onblocked=function(){e.database=!1},b.onupgradeneeded=function(){var a=e.database=this.result;try{for(var b=a.objectStoreNames?a.objectStoreNames.length:0;b--;)a.deleteObjectStore(a.objectStoreNames[b]);e.database.createObjectStore(e.gns,{keyPath:"id",autoIncrement:!1}).createIndex("date","date",{unique:!1})}catch(c){}},b.onsuccess=function(){try{e.database=this.result,m=
f.dbStore(),m.get("_version").onsuccess=function(){this.result&&g!==this.result.title?(e.database.close(),l.deleteDatabase(c),e.database=l,f.database()):(f.dbVersion(g),f.dbCurrent(),f.dbTitle(e.location.href,z.title))}}catch(a){e.database.close(),l.deleteDatabase(c),e.database=!1}},b.onerror=function(b){e.database=!1;l.deleteDatabase(c);setTimeout(function(){database(++a)},1E3)}}catch(n){e.database=!1}},dbStore:function(){var a=f.settings[1];return"object"===typeof a.database&&"function"===typeof a.database.transaction&&
a.database.transaction(a.gns,"readwrite").objectStore(a.gns)},dbCurrent:function(){var a=f.settings[1],e=f.dbStore();e&&e.put({id:"_current",title:a.hashquery?m.location.href:m.location.href.replace(/#.*/,"")})},dbVersion:function(a){var e=f.dbStore();e&&e.put({id:"_version",title:a})},dbTitle:function(a,e){var k=f.settings[1],l=f.dbStore();l&&(k.hashquery||(a=a.replace(/#.*/,"")),e?l.get(a).onsuccess=function(){l.put(g.extend(!0,{},this.result||{},{id:a,title:e,date:k.timestamp}));f.dbClean(l)}:
l.get(a).onsuccess=function(){this.result&&this.result.title&&(z.title=this.result.title)})},dbScroll:function(a,e){var k=f.settings[1],l=f.dbStore(),c=k.location.href,b=arguments.length;k.scroll.record&&l&&(k.hashquery||(c=c.replace(/#.*/,"")),l.get("_current").onsuccess=function(){this.result&&this.result.title&&c===this.result.title&&(b?l.get(c).onsuccess=function(){l.put(g.extend(!0,{},this.result||{},{scrollX:parseInt(Number(a),10),scrollY:parseInt(Number(e),10)}))}:l.get(c).onsuccess=function(){this.result&&
isFinite(this.result.scrollX)&&isFinite(this.result.scrollY)&&m.scrollTo(parseInt(Number(this.result.scrollX),10),parseInt(Number(this.result.scrollY),10))})})},dbClean:function(a){var e=f.settings[1],g=m.IDBKeyRange||m.webkitIDBKeyRange||m.mozIDBKeyRange||m.msIDBKeyRange;a.count().onsuccess=function(){1E3<this.result&&(a.index("date").openCursor(g.upperBound(e.timestamp-2592E5)).onsuccess=function(){var e=this.result;e?(e["delete"](e.value.id),e["continue"]()):a.count().onsuccess=function(){1E3<
this.result&&a.clear()}})}},share:function(){var a=f.settings[1];g.falsandtru||(g.fn.falsandtru=g.falsandtru=f.falsandtru);g.falsandtru("share","history",a.history);a.history=g.falsandtru("share","history")},falsandtru:function(a,e,f){var l;switch(!0){case e===A:l=g.falsandtru[a];break;case f===A:l=a in g.falsandtru?g.falsandtru[a][e]:A;break;case f!==A:g.falsandtru[a]instanceof Object||(g.falsandtru[a]={}),g.falsandtru[a][e]instanceof Object&&f instanceof Object?g.extend(!0,g.falsandtru[a][e],f):
g.falsandtru[a][e]=f,l=g.falsandtru[a][e]}return l}};(function(a,e,f,g,c){a.fn[c.name]=a[c.name]=function(){return D.apply(this,[a,e,f,g,c].concat([].slice.call(arguments)))};c.setProperties.call(a[c.name])}).apply(this,[].slice.call(arguments).concat([f]))})(jQuery,window,document,void 0);
